# ECMA标准功能封装重构笔记

## 重构状态

这个目录包含所有基于ECMA标准的常用工具函数，是工具箱中最基础的一层。目前已完成部分工具函数的重构。

## 职责范围

- 纯JavaScript标准功能的封装
- 不依赖DOM、BOM或特定平台API
- 提供跨平台一致性行为的工具函数

## 重构原则

1. **纯函数优先**：
   - 优先使用纯函数设计
   - 避免副作用和状态依赖
   - 确保函数输出仅取决于输入

2. **模块化设计**：
   - 按功能域细分子目录
   - 相关功能集中管理
   - 避免功能重复

3. **命名规范**：
   - 使用有意义的中文函数名
   - 同时提供英文别名以保持兼容性

## 重构进度

- ✅ forString - 字符串处理工具（已完成）
- ✅ textTools.js - 文本处理工具（已完成）
- ⏳ forFile - 文件操作相关工具（进行中）
- ⏳ forMath - 数学计算工具（进行中）
- ⏳ forObjectManagement - 对象管理工具（进行中）
- ⏳ forFunctions - 函数式编程工具（进行中）
- ⏳ forCrypto - 加密工具（进行中）
- ⏳ forTime - 时间处理工具（进行中）

## 待处理事项

1. 需要将旧版`基础文本工具.js`内容合并到textTools.js并移除
2. 需要规范子目录命名，统一使用"for"或"use"前缀
3. 将`useString`和`useObject`目录内容迁移到对应的for前缀目录
4. 清理和重构usePromise.js，考虑移动到forFunctions目录

## 注意事项

- 保持工具函数的通用性和平台无关性
- 确保向后兼容性，特别是已被多处引用的函数
- 添加适当的JSDoc注释以提高代码可读性
- 考虑添加单元测试确保功能正确性

# 这个区段由开发者编写,未经允许禁止AI修改
<本模块为ECMA标准对象与功能的扩展与封装，此处包含各种原生JS功能的增强工具>

## performance.js - 性能测量与分析工具

`performance.js` 提供了一套全面的性能监测、测量和分析工具，用于优化函数执行效率和性能瓶颈排查。

### 核心功能

1. **函数性能监测**
   - `withPerformanceLogging(fn)` - 高阶函数，包装目标函数并记录其执行性能
   - 自动跟踪函数调用次数、执行时间、平均时间等指标
   - 支持同步和异步函数（Promise）

2. **性能数据收集与分析**
   - `getPerformanceStats(fn?)` - 获取函数性能统计
   - `clearPerformanceStats(fn?)` - 清除性能统计数据

3. **性能比较工具**
   - `comparePerformance({functions, args, iterations})` - 比较多个函数的性能差异
   - 自动进行多次迭代测试，提供平均值、最小值和最大值

4. **手动性能计时**
   - `performanceTimer.start(label)` - 开始测量
   - `performanceTimer.end(label, log)` - 结束测量并返回耗时

### 使用场景

- 性能瓶颈识别
- 函数优化前后对比
- 算法效率比较
- 系统性能基准测试

### 注意事项

- 性能数据统计存储在内存中，大量使用可能导致内存增长
- 生产环境中应谨慎使用带日志输出的功能
- 微小时间差异（<1ms）可能不具有统计意义

### 迁移说明

该模块从 `source/utils/functionAndClass/performanceRun.js` 迁移而来，并进行了以下增强：

1. 增加了更全面的性能统计指标（最小/最大/平均时间）
2. 添加了函数性能比较工具
3. 提供了手动性能计时器
4. 支持清除性能统计数据

原路径的 `withPerformance` 函数已通过兼容导出保留，建议使用新的 `withPerformanceLogging` 函数。 