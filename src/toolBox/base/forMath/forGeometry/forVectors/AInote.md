# 向量计算工具开发笔记

## 设计理念

向量计算模块采用函数式风格设计，避免使用类，专注于提供高性能的纯函数实现。所有函数都遵循以下规则：

1. 使用 `compute*` 前缀表示纯计算函数
2. 尽可能避免副作用和修改输入参数
3. 优先考虑性能和内存效率
4. 保持函数接口简单明了

## 性能优化记录

### forDistance.js

1. 使用 `length` 缓存数组长度，避免在循环中重复访问
2. 对于余弦相似度，用 `a[i] * a[i]` 替代 `Math.pow(a[i], 2)` 提升性能
3. 对于欧几里得距离，优化平方和计算
4. 增加零值检查，避免除零错误

### forNormalization.js

1. 使用 `reduce` 进行向量长度计算，避免额外的循环
2. 针对零向量情况做特殊处理

## 重构记录

1. 2024-04-05: 
   - 规范化命名，将中文函数名更改为英文命名
   - 移除了所有默认导出
   - 将散落的距离计算函数集中到 forDistance.js
   - 从 useCustomedHNSW.js 中分离出通用距离计算函数

## 待优化项

1. 考虑使用 TypedArrays (Float32Array) 来提高大型向量计算性能
2. 对于高维向量，考虑添加近似距离计算方法
3. 添加向量批量操作函数，支持并行计算
4. 考虑增加SIMD优化，如果运行环境支持

## 扩展计划

### 近期计划

1. 添加基本向量运算函数：
   - 向量加法、减法
   - 向量点积、叉积
   - 向量投影
   - 向量旋转

2. 增加更多距离度量：
   - 闵可夫斯基距离
   - 马氏距离
   - 地理距离（哈弗辛公式）
   - KL散度和JS散度

### 长期计划

1. 添加向量分析工具：
   - 主成分分析 (PCA)
   - 奇异值分解 (SVD)
   - 向量空间变换

2. 添加几何计算工具：
   - 三角形、多边形、球体等计算
   - 射线和平面的交点计算
   - 凸包计算

## 注意事项

1. 确保所有函数都能同时处理 Array 和 TypedArray (Float32Array) 类型
2. 在添加新功能时记得更新对应的 README.md
3. 所有新函数都应遵循现有的命名规范
4. 优先考虑性能，其次是代码可读性 