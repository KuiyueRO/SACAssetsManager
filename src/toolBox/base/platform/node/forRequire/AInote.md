# 这个区块由开发者编写,未经允许禁止AI修改

**职责范围 (Scope):** 提供与 Node.js 的 `require` 机制相关的底层操作和扩展功能。

**所属层级:** Base (`base/useNode/forRequire`)

**例外说明 (Exception Justification):**
本目录下的 `hackRequire.js` 模块通过修改全局 `require` 和 `module.load` 的行为来扩展 Node.js 的模块搜索路径。虽然这**违反了**工具箱通常避免修改全局状态和进行底层 hack 的原则，但此机制对于**支撑项目的核心扩展系统至关重要**。

类似于 Rubick 或 uTools 等平台的扩展机制，本项目需要允许**每个扩展（可能运行在独立上下文中）拥有并加载自己独立的依赖环境**，而无需进行复杂的路径配置或担心与主应用或其他扩展的依赖冲突。`hackRequire.js` 提供的动态扩展搜索路径能力，是实现这种**低耦合、易于开发的扩展生态**的关键基础设施。

因此，在找到不牺牲扩展开发便利性和独立性的、更优的依赖加载方案之前，将此实现标记为**必要的例外**。

**准入标准 (Criteria):**
- 必须是与 Node.js `require` 机制直接相关的底层功能。
- 通常**禁止**依赖 `feature` 或 `useAge` 层的任何模块 (除非特殊情况如需要插件上下文)。
- **禁止**包含特定应用的业务逻辑或 UI 逻辑。
- **禁止**直接依赖外部库。
- **命名规范:** 必须遵循 [`../../../GUIDELINES.md`](../../../GUIDELINES.md) 中定义的函数命名规范和 **"流畅优美的文式编程风格"** 核心要求。

**架构总纲:** [`../../../architecture_layers_explained.md`](../../../architecture_layers_explained.md)

---

# AI 笔记 - Node.js Require 扩展 (forRequire)

## 历史记录与重要变更

*   **2024-07-30 (织):**
    *   确认 `hackRequire.js` (原位于 `trashed/`) 已迁移至此目录。
    *   确认项目中使用此模块来支持**核心扩展机制**，允许扩展加载自身独立的依赖。
    *   根据开发者指示，将此模块标记为**必要的例外**。
    *   **潜在风险:** 修改全局 `require` 行为可能带来潜在的兼容性问题或难以调试的副作用，未来若有更安全的替代方案应考虑重构，但需确保不影响扩展开发的便利性。 