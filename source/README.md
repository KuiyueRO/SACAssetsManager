# 源代码目录 (Source)

本目录包含插件的原始源代码，包括UI组件、工具函数、服务器端代码等。

## 目录结构

- `UI/` - 用户界面组件，包括面板、对话框等
- `utils/` - 通用工具函数
- `server/` - 服务器端代码
- `servicies/` - 业务服务实现
- `events/` - 事件处理相关代码
- `shared/` - 共享代码和模块
- `host/` - 宿主环境集成代码
- `polyfills/` - 兼容性填充代码
- `fromDeps/` - 来自依赖的代码
- `fromThirdParty/` - 第三方代码
- `fromRuntime/` - 运行时相关代码
- `triggers/` - 触发器相关代码
- `noteChat/` - 笔记聊天功能相关代码
- `globalStatus/` - 全局状态管理
- `data/` - 数据处理相关代码
- `URT/` - 用户响应时间相关代码
- `utilWebviews/` - Webview工具
- `previewers/` - 预览器相关代码
- `wgslLibs/` - WGSL着色器库

## 主要文件

- `index.js` - 源代码入口文件
- `asyncModules.js` - 异步模块加载
- `constants.js` - 常量定义
- `pluginSymbolRegistry.js` - 插件符号注册

## 代码组织原则

1. **模块化**：
   - 相关功能集中在同一目录
   - 每个模块有明确的职责
   - 通过明确的接口暴露功能

2. **分层设计**：
   - UI层 - 负责用户界面
   - 服务层 - 提供业务功能
   - 工具层 - 提供通用功能
   - 数据层 - 处理数据存储和操作

3. **依赖管理**：
   - 明确模块间的依赖关系
   - 避免循环依赖
   - 合理组织代码导入顺序

4. **兼容性**：
   - 确保代码在不同环境中正常工作
   - 使用polyfills提供兼容性支持
   - 处理浏览器和Node.js环境差异

## 重构目标

本目录的重构目标是将代码逐步迁移到src目录下的新架构中，遵循以下步骤：

1. 分析现有代码结构和功能
2. 将通用工具函数迁移到toolBox中
3. 将业务服务迁移到services中
4. 将UI组件和模块迁移到modules中

## 使用指南

在重构过程中，新代码应遵循以下规范：

1. 使用ES模块语法（import/export）
2. 遵循函数式编程风格
3. 避免直接依赖全局状态
4. 使用中文命名函数和变量
5. 添加适当的文档和注释

## 注意事项

- 重构过程中保持向后兼容性
- 逐步替换旧代码，避免一次性大规模改动
- 测试重构后的功能，确保正常工作
- 及时更新文档反映最新架构 