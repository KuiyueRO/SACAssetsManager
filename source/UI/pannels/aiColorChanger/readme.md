# AI助手工具调用功能

## 功能概述

AI助手工具调用功能是对思源笔记AI能力的扩展，允许用户通过自然语言指令触发特定操作，如内容扩充、日记写入等。该功能将AI的理解能力与实际系统操作结合，提供更智能的工作流体验。

## 主要特性

1. **自然语言操作**：使用日常语言描述任务，无需记忆复杂命令
2. **内容扩充**：将简短内容自动扩充为详细段落
3. **日记写入**：自动创建或更新思源笔记日记，添加AI扩充的内容
4. **界面友好**：直观的用户界面，提供即时反馈和状态信息
5. **智能意图识别**：系统能够分析用户输入，提取操作类型和参数

## 使用方法

### 基本指令格式

工具调用功能支持多种自然语言表达方式，主要功能包括：

1. **内容扩充**：
   - 示例：`扩充一下：今天学习了AI工具调用`
   - 示例：`将这段话详细描述：春天来了，花儿开了`

2. **写入日记**：
   - 示例：`记到日记里：今天完成了项目的首个版本`
   - 示例：`写到日记中：参加了一个有趣的讲座`

### 操作步骤

1. 打开AI工具指令面板
2. 在输入框中输入自然语言指令
3. 点击"执行"按钮
4. 查看执行结果和反馈信息

### 示例使用场景

#### 场景一：内容扩充

**输入**：`扩充一下：今天学习了AI工具调用功能`

**输出**：
```
今天，我深入学习了AI工具调用功能，这是一项令人兴奋的技术进步。通过这个功能，
用户可以使用自然语言直接指示AI执行特定操作，如内容扩充、信息整理和数据分析等。

这种交互方式极大地简化了人机交流，不再需要记忆复杂的命令或点击众多菜单选项。
学习过程中，我尝试了各种指令模式，并惊喜地发现AI能够准确理解我的意图，将简单
的描述转化为具体的行动。

这项功能的底层技术结合了自然语言处理和意图识别算法，代表了人工智能在日常工具
中的实际应用。我相信随着技术的发展，这类智能交互将成为未来软件的标准配置。
```

#### 场景二：写入日记

**输入**：`记到日记里：参加了团队建设活动`

**输出**：
```
内容已添加到今日日记

扩充内容预览:
今天参加了团队建设活动，这是一次充满欢笑和收获的体验。活动在公司附近的一个开放式场地举行，所有团队成员都积极参与其中。

上午我们进行了一系列的破冰游戏，帮助彼此更好地了解团队中每个人的特点和优势。特别是"信任倒立"这个环节，让我深刻体会到团队合作的重要性和信任的力量。

午餐时间，我们一起分享了丰盛的自助餐，在轻松的氛围中交流工作和生活中的见闻。下午的挑战任务则更具策略性，要求我们在有限的资源和时间内完成一个小型项目。我们团队通过有效沟通和分工协作，成功地在规定时间内完成了任务。

这次活动不仅增强了团队凝聚力，也让我对同事们有了更深入的了解。回顾今天的体验，我认识到良好的团队氛围对工作效率和个人成长都有积极影响。期待未来有更多类似的团队活动。
```

## 技术实现

### 核心组件

1. **工具命令处理器**：分析用户输入，识别工具调用意图并执行相应操作
2. **意图识别系统**：结合规则匹配和AI分析，提取用户指令中的操作类型和参数
3. **工具注册机制**：提供可扩展的接口，允许注册和管理自定义工具
4. **AI内容扩充**：使用思源笔记AI接口实现文本内容的智能扩充
5. **思源API集成**：通过思源笔记API实现日记创建和内容添加功能

### 文件结构

- `toolCommandProcessor.js` - 核心处理逻辑和工具管理器
- `ToolExecutionPanel.vue` - 用户界面组件
- `AInote.md` - 功能说明和实现细节
- `readme.md` - 使用指南和功能介绍

## 自定义扩展

开发者可以通过以下方式扩展工具调用功能：

1. **添加新工具**：
   ```javascript
   // 在toolCommandProcessor.js中注册新工具
   toolManager.register({
     myNewTool: async (parameters) => {
       // 实现新工具的逻辑
       const result = await doSomething(parameters);
       return { 
         success: true, 
         message: `操作结果: ${result}` 
       };
     }
   });
   ```

2. **增强意图识别**：
   ```javascript
   // 在analyzeToolIntent函数中添加新的模式识别
   if (userInput.includes('某个关键词')) {
     const contentMatch = userInput.match(/匹配模式(.+)$/);
     if (contentMatch && contentMatch[1]) {
       return {
         isToolCall: true,
         toolName: 'myNewTool',
         parameters: contentMatch[1].trim()
       };
     }
   }
   ```

## 兼容性和限制

- 工具调用功能依赖思源笔记的AI接口，需确保思源笔记配置了可用的AI服务
- 日记写入功能需要思源笔记具有"日记"笔记本
- 复杂指令可能需要多次AI分析，处理时间相对较长

## 常见问题

1. **为什么我的指令没有被识别为工具调用？**
   - 尝试使用更明确的表达，如"扩充一下："、"记到日记里："等
   - 确保指令内容完整，包含清晰的操作意图和参数

2. **内容扩充后文本太长或太短？**
   - 可以调整系统提示词，指定期望的扩充长度
   - 提供更具体的原始内容，引导AI生成符合期望的扩充文本

3. **日记功能返回创建失败？**
   - 确认思源笔记中存在"日记"笔记本
   - 检查网络连接和思源API权限设置

## 更新计划

- [ ] 支持更多工具类型，如内容总结、提取关键点等
- [ ] 增加用户偏好设置，允许自定义模板和参数
- [ ] 提供历史记录功能，方便重用之前的操作
- [ ] 多语言支持，包括英文指令识别

## 贡献指南

欢迎对本功能进行改进和扩展。如需贡献代码，请确保：

1. 遵循现有代码风格和命名规范
2. 为新功能添加完整的文档和测试
3. 提交前测试所有功能的兼容性

## 许可协议

与思源笔记插件保持一致的开源协议

# AI工具指令面板使用说明

## 功能概述

AI工具指令面板允许用户通过自然语言输入指令来执行各种操作，如扩充内容、写入日记等。面板具有以下特点：

- 支持自然语言指令识别
- 提供流式响应，实时显示AI生成内容
- 支持自定义AI模型选择
- 内置多种工具功能

## 常用指令示例

### 扩充内容
```
扩充一下：今天学习了如何使用AI工具
```

### 写入日记
```
记到日记里：尝试了新的工作方法，效率提高了
```

## 高级选项

### 自定义模型
点击"高级选项"展开面板，可以：

1. 选择模型提供商（默认使用思源全局模型）
2. 选择特定模型（当选择非全局模型时）
3. 调整模型参数：
   - 温度：控制输出的随机性，值越高结果越多样
   - 上下文：控制对话历史长度，影响模型对前文的理解

### 温度参数说明
- 0.0-0.3：输出更确定、保守
- 0.4-0.7：平衡创造性和一致性（推荐）
- 0.8-1.0：输出更多样、创造性
- 1.0以上：结果更随机、非常规

### 上下文长度选择
- 单轮对话：仅考虑当前输入
- 短上下文(3轮)：记住最近3轮对话
- 中等上下文(5轮)：记住最近5轮对话
- 长上下文(10轮)：记住最近10轮对话

## 使用场景

1. **快速扩充笔记**：将简短思路扩展为完整段落
2. **高效记录日记**：简短描述自动扩充并记录到日记中
3. **自定义AI响应风格**：通过调整温度参数控制AI输出风格
4. **尝试不同模型**：比较不同模型的输出效果和特点

## 注意事项

- 模型选择会应用于所有操作，包括指令识别和内容生成
- 部分模型可能需要联网访问相应的模型提供商服务
- 较高的温度设置可能导致输出结果不一致或偏离预期 