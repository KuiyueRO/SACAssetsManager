<template>
    <div class="fn__flex-column editor-container">
        <div class="fn__flex fn__flex-1">
            <!-- Â∑¶‰æßÂ∑•ÂÖ∑Ê†è -->
            <div class="tools-bar">
                <div class="tool-group">
                    <div class="tool-item" :class="{ active: currentTool === 'components' }"
                        @click="handleToolClick('components')">
                        <i class="icon">üß©</i>
                        <span>ÁªÑ‰ª∂</span>
                    </div>
                    <div class="tool-item" :class="{ active: currentTool === 'pages' }"
                        @click="handleToolClick('pages')">
                        <i class="icon">üìÑ</i>
                        <span>È°µÈù¢</span>
                    </div>
                    <div class="tool-item" :class="{ active: currentTool === 'assets' }"
                        @click="handleToolClick('assets')">
                        <i class="icon">üñºÔ∏è</i>
                        <span>ËµÑÊ∫ê</span>
                    </div>
                </div>
            </div>

            <!-- Â∑¶‰æßÈù¢Êùø -->
            <div class="left-panel" v-if="currentTool === 'components'">
                <div class="section-title">ÁªÑ‰ª∂Â∫ì</div>
                <div class="panel-content">
                    <div class="component-categories">
                        <div v-for="category in componentCategories" :key="category.id" class="category-section">
                            <div class="category-header" @click="toggleCategory(category.id)">
                                <span class="category-icon">{{ category.expanded ? '‚ñº' : '‚ñ∂' }}</span>
                                <span class="category-title">{{ category.name }}</span>
                            </div>
                            <div class="component-grid" v-show="category.expanded">
                                <div v-for="comp in category.components" :key="comp.id" class="component-item"
                                    draggable="true" @dragstart="handleDragStart($event, comp)">
                                    <span class="component-icon">{{ comp.icon }}</span>
                                    <span class="component-name">{{ comp.name }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ê∑ªÂä†È°µÈù¢ÁªìÊûÑÈù¢Êùø -->
            <div class="left-panel" v-if="currentTool === 'layers'">
                <div class="section-title">È°µÈù¢ÁªìÊûÑ</div>
                <div class="panel-content">
                    <div class="component-tree">
                        <template v-for="node in getComponentTree" :key="node.id">
                            <div class="component-tree-node" :style="{ paddingLeft: `${node.level * 20}px` }"
                                :class="{ 'selected': selectedComponent?.id === node.id }"
                                @click="selectComponent(node.id)">
                                <span class="component-icon">{{ getComponentIcon(node.type) }}</span>
                                <span class="component-name">{{ node.name }}</span>
                                <div class="node-actions">
                                    <button class="action-btn delete-btn" @click.stop="deleteComponent(node.id)"
                                        title="Âà†Èô§ÁªÑ‰ª∂">
                                        <i class="icon">üóëÔ∏è</i>
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

            <!-- ‰∏ªÁºñËæëÂå∫Âüü -->
            <div class="fn__flex fn__flex-1 fn__flex-column editor-main">
                <!-- È°∂ÈÉ®Â∑•ÂÖ∑Ê†è -->
                <div class="editor-toolbar">
                    <div class="toolbar-group">
                        <button class="toolbar-btn" title="Êí§ÈîÄ" @click="undo">
                            <i class="icon">‚Ü©Ô∏è</i>
                        </button>
                        <button class="toolbar-btn" title="ÈáçÂÅö" @click="redo">
                            <i class="icon">‚Ü™Ô∏è</i>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" :class="{ active: isPreviewMode }" title="È¢ÑËßàÊ®°Âºè"
                            @click="togglePreviewMode">
                            <i class="icon">üëÅÔ∏è</i>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" title="ÂèëÂ∏É" @click="publish">
                            <i class="icon">üöÄ</i>
                        </button>
                    </div>

                    <!-- ËÆæÂ§áÈÄâÊã©Âô® -->
                    <div class="device-selector">
                        <button class="toolbar-btn" :class="{ active: currentDevice === 'desktop' }"
                            @click="switchDevice('desktop')">
                            <i class="icon">üñ•Ô∏è</i>
                        </button>
                        <button class="toolbar-btn" :class="{ active: currentDevice === 'tablet' }"
                            @click="switchDevice('tablet')">
                            <i class="icon">üì±</i>
                        </button>
                        <button class="toolbar-btn" :class="{ active: currentDevice === 'mobile' }"
                            @click="switchDevice('mobile')">
                            <i class="icon">üì±</i>
                        </button>
                    </div>

                    <!-- Áº©ÊîæÊéßÂà∂ -->
                    <div class="zoom-control">
                        <NumberInput
                            v-model="zoom"
                            :min="0.2"
                            :max="2"
                            :step="0.1"
                            unit="%"
                            :precision="0"
                            @update:modelValue="updatePreviewZoom"
                        />
                    </div>
                </div>

                <!-- ÁîªÂ∏ÉÂÆπÂô® -->
                <div class="editor-workspace" @dragover.prevent @dragenter.prevent @drop.prevent="handleDrop">
                    <div class="editor-content-full">
                        <iframe :ref="el => previewFrame = el" class="preview-frame" @load="handleIframeLoad">
                        </iframe>
                    </div>
                </div>
            </div>

            <!-- Âè≥‰æßÂ±ûÊÄßÈù¢Êùø -->
            <div class="right-panel">
                <div class="section-title">Â±ûÊÄßËÆæÁΩÆ</div>
                <div class="panel-content">
                    <template v-if="selectedComponent">
                        <!-- Ê†∑ÂºèËÆæÁΩÆ -->
                        <div class="property-section">
                            <h3>Ê†∑Âºè</h3>
                            <div class="property-group">
                                <div class="property-item">
                                    <label>ÂÆΩÂ∫¶</label>
                                    <input type="text" v-model="selectedComponent.style.width">
                                </div>
                                <div class="property-item">
                                    <label>ÔøΩÔøΩÂ∫¶</label>
                                    <input type="text" v-model="selectedComponent.style.height">
                                </div>
                            </div>
                        </div>

                        <!-- ÁªÑ‰ª∂Â±ûÊÄß -->
                        <div class="property-section">
                            <h3>Â±ûÊÄß</h3>
                            <component :is="getPropertyEditor(selectedComponent.type)"
                                v-model="selectedComponent.props" />
                        </div>

                        <!-- Ë°å‰∏∫ËÆæÁΩÆ -->
                        <div class="property-section" v-if="getComponentBehaviors.length">
                            <h3>‰∫§‰∫íË°å‰∏∫</h3>
                            <div v-for="behaviorType in getComponentBehaviors" :key="behaviorType">
                                <div class="behavior-header">
                                    <span>{{ behaviors[behaviorType].name }}</span>
                                    <div class="switch-toggle">
                                        <input type="checkbox" :id="'behavior-' + behaviorType"
                                            v-model="selectedComponent.behaviors[behaviorType].enabled"
                                            @change="updatePreview" />
                                        <label :for="'behavior-' + behaviorType"></label>
                                    </div>
                                </div>
                                <template v-if="selectedComponent.behaviors[behaviorType].enabled">
                                    <div v-for="(event, eventName) in behaviors[behaviorType].events" :key="eventName"
                                        class="behavior-event">
                                        <div class="event-header">{{ event.name }}</div>
                                        <div class="event-params">
                                            <template v-for="(param, paramName) in event.params" :key="paramName">
                                                <div class="param-item">
                                                    <label>{{ param.name }}</label>
                                                    <input v-if="param.type === 'string'" type="text"
                                                        v-model="selectedComponent.behaviors[behaviorType][eventName][paramName]"
                                                        @change="updatePreview" class="input-control" />
                                                    <input v-else-if="param.type === 'number'" type="number"
                                                        v-model.number="selectedComponent.behaviors[behaviorType][eventName][paramName]"
                                                        @change="updatePreview" class="input-control" />
                                                    <select v-else-if="param.type === 'select'"
                                                        v-model="selectedComponent.behaviors[behaviorType][eventName][paramName]"
                                                        @change="updatePreview" class="select-control">
                                                        <option v-for="option in param.options" :key="option.value"
                                                            :value="option.value">
                                                            {{ option.label }}
                                                        </option>
                                                    </select>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                    <div v-else class="empty-tip">
                        ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÁªÑ‰ª∂ËøõË°åÁºñËæë
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<script setup>
import { ref, computed, onMounted, onUnmounted, nextTick, watch } from 'vue';
import { componentManager, componentTreeManager, componentConfigs } from './componentConfig.js';
import DefaultPropertyEditor from './DefaultPropertyEditor.vue';
import { behaviors } from './componentConfig.js';
import { dragDropManager } from './dragDropManager.js';
import { buildExportContent } from './exportContentFrame.js';
import NumberInput from '../../components/NumberInput.vue';


// Áä∂ÊÄÅÂÆö‰πâ
const currentTool = ref('components');
const currentDevice = ref('desktop');
const zoom = ref(1);
const selectedComponent = ref(null);
const pageComponents = ref([]); // Â≠òÂÇ®È°µÈù¢‰∏≠ÁöÑÁªÑ‰ª∂
const isPreviewMode = ref(false);
const previewFrame = ref(null);

// Ê®°ÊãüÊï∞ÊçÆ
const componentCategories = ref([
    {
        id: 'basic',
        name: 'Âü∫Á°ÄÁªÑ‰ª∂',
        expanded: true, // ÈªòËÆ§Â±ïÂºÄ
        components: [
            { id: 'text', name: 'ÊñáÊú¨', icon: 'üìù' },
            { id: 'image', name: 'ÂõæÁâá', icon: 'üñºÔ∏è' },
            { id: 'button', name: 'ÊåâÈíÆ', icon: 'üîò' },
            { id: 'divider', name: 'ÂàÜÂâ≤Á∫ø', icon: '‚ö°' }
        ]
    },
    {
        id: 'layout',
        name: 'Â∏ÉÂ±ÄÁªÑ‰ª∂',
        expanded: false,
        components: [
            { id: 'container', name: 'ÂÆπÂô®', icon: 'üì¶' },
            { id: 'grid', name: 'ÁΩëÊ†º', icon: 'üî≤' },
            { id: 'flex', name: 'ÂºπÊÄßÂ∏ÉÂ±Ä', icon: '‚ÜîÔ∏è' }
        ]
    },
    {
        id: 'form',
        name: 'Ë°®ÂçïÁªÑ‰ª∂',
        components: [
            { id: 'input', name: 'ËæìÂÖ•Ê°Ü', icon: '‚úèÔ∏è' },
            { id: 'select', name: '‰∏ãÊãâÈÄâÊã©', icon: '‚ñº' },
            { id: 'checkbox', name: 'Â§çÈÄâÊ°Ü', icon: 'ÔøΩÔøΩÔ∏è' },
            { id: 'radio', name: 'ÂçïÈÄâÊ°Ü', icon: '‚≠ï' },
            { id: 'form', name: 'Ë°®Âçï', icon: 'üìã' }
        ]
    },
    {
        id: 'content',
        name: 'ÂÜÖÂÆπÂ±ïÁ§∫',
        components: [
            { id: 'list', name: 'ÂàóË°®', icon: 'üìù' },
            { id: 'table', name: 'Ë°®Ê†º', icon: 'üóÉÔ∏è' },
            { id: 'card', name: 'Âç°Áâá', icon: 'üé¥' },
            { id: 'carousel', name: 'ËΩÆÊí≠Âõæ', icon: 'üéûÔ∏è' }
        ]
    },
    {
        id: 'navigation',
        name: 'ÂØºËà™ÁªÑ‰ª∂',
        components: [
            { id: 'menu', name: 'ËèúÂçï', icon: 'üìë' },
            { id: 'tabs', name: 'Ê†áÁ≠æÈ°µ', icon: 'üìë' },
            { id: 'breadcrumb', name: 'Èù¢ÂåÖÂ±ë', icon: 'üîó' }
        ]
    }
]);



// ÊñπÊ≥ïÂÆö‰πâ
const handleToolClick = (tool) => {
    currentTool.value = tool;
};

const switchDevice = (device) => {
    currentDevice.value = device;
    updatePreviewDevice(device);
};

// ÂàùÂßãÂåñÊãñÊãΩÁÆ°ÁêÜÂô®
onMounted(() => {
    dragDropManager.init(
        updatePreview,
        (component) => selectedComponent.value = component
    );
    console.log('Component mounted');

    // ËÆæÁΩÆÈ¢ÑËßàÈ°µÈù¢ÁöÑURL
    nextTick(() => {
        if (previewFrame.value) {
            const previewUrl = new URL('/plugins/SACAssetsManager/source/UI/pannels/pageEditor/previewer.html', window.location.href);
            previewFrame.value.src = previewUrl.href;
            console.log('Preview URL set:', previewUrl.href);
        } else {
            console.error('Preview frame not available in onMounted');
        }
    });


    // ‰øÆÊîπÊãñÊãΩÁõ∏ÂÖ≥ÁöÑ‰∫ã‰ª∂ÁõëÂê¨
    const editorWorkspace = document.querySelector('.editor-workspace');
    if (editorWorkspace) {
        editorWorkspace.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
            e.dataTransfer.dropEffect = 'copy';
        });
    }

    // Ê∑ªÂä† iframe Ê∂àÊÅØÁõëÂê¨
    window.addEventListener('message', handleMessage);
    console.log('Message listener added');

    // Ê∑ªÂä†Ê∂àÊÅØÁõëÂê¨Âô®
    window.addEventListener('message', (event) => {
        if (event.data.type === 'componentSelected') {
            handleComponentSelect(event.data.componentId);
        }
        // ... ÂÖ∂‰ªñÊ∂àÊÅØÂ§ÑÁêÜ ...
    });
});

// Ê∑ªÂä†ÁªÑ‰ª∂Âç∏ËΩΩÊó∂ÁöÑÊ∏ÖÁêÜ
onUnmounted(() => {
    const editorWorkspace = document.querySelector('.editor-workspace');
    if (editorWorkspace) {
        editorWorkspace.removeEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
        });
    }
    window.removeEventListener('message', handleMessage);
});

const updatePreviewDevice = (device) => {
    if (previewFrame.value?.contentWindow) {
        previewFrame.value.contentWindow.postMessage({
            type: 'updateDevice',
            device: device
        }, '*');
    }
};

const updatePreviewZoom = (newZoom) => {
    if (previewFrame.value?.contentWindow) {
        previewFrame.value.contentWindow.postMessage({
            type: 'updateZoom',
            zoom: newZoom
        }, '*');
    }
};

// Ê∑ªÂä†ÁªÑ‰ª∂hoverÂ§ÑÁêÜÊñπÊ≥ï
const handleComponentHover = (componentId) => {
    if (previewFrame.value?.contentWindow) {
        previewFrame.value.contentWindow.postMessage({
            type: 'highlightComponent',
            componentId: componentId
        }, '*');
    }
};

// Ëé∑ÂèñÁªÑ‰ª∂ÊîØÊåÅÁöÑË°å‰∏∫
const getComponentBehaviors = computed(() => {
    if (!selectedComponent.value) return [];
    const config = componentConfigs[selectedComponent.value.type];
    return config?.behaviors || [];
});

// ÂàáÊç¢È¢ÑËßàÊ®°Âºè
const togglePreviewMode = () => {
    isPreviewMode.value = !isPreviewMode.value;
    // ÈÄöÁü•È¢ÑËßàÊ°ÜÊû∂Êõ¥Êñ∞Ê®°Âºè
    if (previewFrame.value?.contentWindow) {
        previewFrame.value.contentWindow.postMessage({
            type: 'updateMode',
            isPreviewMode: isPreviewMode.value
        }, '*');
    }
};

// Ê∑ªÂä†È°µÈù¢ÁªìÊûÑÂ±ïÁ§∫Áõ∏ÂÖ≥‰ª£Á†Å
const getComponentTree = computed(() =>
    componentTreeManager.buildComponentTree(pageComponents.value)
);
const getComponentIcon = (type) => componentManager.getComponentIcon(type);

// Ê∑ªÂä†ÁªÑ‰ª∂Ê†ëÊ∏≤ÊüìÊ®°Êùø
const renderComponentTree = (tree) => {
    return tree.map(node => `
        <div class="component-tree-node" 
             style="padding-left: ${node.level * 20}px"
             :class="{ 'selected': selectedComponent?.id === node.id }"
             @click="selectComponent(node.id)">
            <span class="component-icon">${getComponentIcon(node.type)}</span>
            <span class="component-name">${node.name}</span>
            ${node.children.length ? renderComponentTree(node.children) : ''}
        </div>
    `).join('');
};

// ÂàáÊç¢ÂàÜÁ±ªÂ±ïÂºÄ/ÊäòÂè†
const toggleCategory = (categoryId) => {
    const category = componentCategories.value.find(c => c.id === categoryId);
    if (category) {
        category.expanded = !category.expanded;
    }
};

// ‰øÆÊîπ handleDragStart
const handleDragStart = (event, component) => {
    dragDropManager.handleDragStart(event, component);
};

// ‰øÆÊîπ handleMessage ÂáΩÊï∞ÔºåÊ∑ªÂä†Êó•ÂøóËæìÂá∫‰ª•‰æøË∞ÉËØï
const handleMessage = (event) => {
    console.log('Received message:', event.data); // Ë∞ÉËØïÊó•Âøó

    if (event.data.type === 'exportPage') {
        console.log('Export content length:', event.data.content?.length); // Ê£ÄÊü•ÂÜÖÂÆπÊòØÂê¶Â≠òÂú®
        handleExport(event.data.content);
        return; // Á°Æ‰øùÂØºÂá∫Ê∂àÊÅØË¢´‰ºòÂÖàÂ§ÑÁêÜ
    }

    switch (event.data.type) {
        case 'iframe-dragover':
            dragDropManager.handleIframeDragOver(event.data);
            break;

        case 'iframe-drop':
            dragDropManager.handleIframeDrop(event.data, pageComponents.value);
            break;

        case 'componentSelected':
            const selectedId = event.data.componentId;
            selectedComponent.value = pageComponents.value.find(
                comp => comp.id === selectedId
            );
            break;

        case 'componentHover':
            handleComponentHover(event.data.componentId);
            break;
        case 'menuAction':
            handleMenuAction(event.data);
            break;

    }
};
const handleMenuAction = (data) => {
    const { action, componentId } = data;
    
    switch(action) {
        case 'delete':
            // ÈÄíÂΩíÂà†Èô§ÁªÑ‰ª∂ÂèäÂÖ∂Â≠êÁªÑ‰ª∂
            const deleteComponent = (components) => {
                return components.filter(comp => {
                    if (comp.id === componentId) {
                        return false;
                    }
                    if (comp.children) {
                        comp.children = deleteComponent(comp.children);
                    }
                    return true;
                });
            };
            
            pageComponents.value = deleteComponent(pageComponents.value);
            
            // Â¶ÇÊûúË¢´Âà†Èô§ÁöÑÁªÑ‰ª∂ÊòØÂΩìÂâçÈÄâ‰∏≠ÁöÑÁªÑ‰ª∂ÔºåÊ∏ÖÈô§ÈÄâ‰∏≠Áä∂ÊÄÅ
            if (selectedComponent.value?.id === componentId) {
                selectedComponent.value = null;
            }
            break;
            
        // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†ÂÖ∂‰ªñËèúÂçïÊìç‰ΩúÁöÑÂ§ÑÁêÜ
        case 'edit':
            // Â§ÑÁêÜÁºñËæëÊìç‰Ωú
            break;
            
        case 'add':
            // Â§ÑÁêÜÊ∑ªÂä†Êìç‰Ωú
            break;
    }
};
// Ê∑ªÂä†Â±ûÊÄßÁºñËæëÂô®Êò†Â∞Ñ
const getPropertyEditor = (componentType) => {
    const editors = {
        text: 'TextPropertyEditor',
        button: 'ButtonPropertyEditor',
        image: 'ImagePropertyEditor'
    };
    return editors[componentType] || 'DefaultPropertyEditor';
};



// Ê∑ªÂä† updatePreview ÊñπÊ≥ï
const updatePreview = () => {
    if (previewFrame.value?.contentWindow) {
        // ÂàõÂª∫‰∏Ä‰∏™ÂèØÂ∫èÂàóÂåñÁöÑÁªÑ‰ª∂Êï∞ÊçÆÂâØÊú¨
        const serializableComponents = JSON.parse(JSON.stringify(pageComponents.value));

        previewFrame.value.contentWindow.postMessage({
            type: 'updateComponents',
            components: serializableComponents,
            selectedId: selectedComponent.value?.id
        }, '*');
    }
};

// ÁõëÂê¨ÁªÑ‰ª∂ÂèòÂåñÂπ∂Êõ¥Êñ∞È¢ÑËßà
watch(pageComponents, () => {
    updatePreview();
}, { deep: true });

// ÁõëÂê¨ÈÄâ‰∏≠ÁªÑ‰ª∂ÂèòÂåñÂπ∂Êõ¥Êñ∞È¢ÑËßà
watch(selectedComponent, () => {
    updatePreview();
});

// ‰øÆÊîπÂØºÂá∫Â§ÑÁêÜÂáΩÊï∞
const handleExport = (htmlContent) => {
    console.log('Starting export process...');

    if (!htmlContent) {
        console.error('No content to export');
        window.$message?.error('ÂØºÂá∫Â§±Ë¥•ÔºöÊ≤°ÊúâÂèØÂØºÂá∫ÁöÑÂÜÖÂÆπ');
        return;
    }

    try {
        // Ê∑ªÂä†ÂøÖË¶ÅÁöÑ‰æùËµñÂíåÊ†∑Âºè
        const exportContent = buildExportContent(getComponentStyles,handleBehavior,htmlContent)

        // ÂàõÂª∫Âπ∂‰∏ãËΩΩÊñá‰ª∂
        const blob = new Blob([exportContent], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const fileName = `page-${new Date().getTime()}.html`;
        
        const link = document.createElement('a');
        link.href = url;
        link.download = fileName;
        link.click();
        
        setTimeout(() => URL.revokeObjectURL(url), 100);
        window.$message?.success('È°µÈù¢ÂØºÂá∫ÊàêÂäüÔºÅ');
    } catch (error) {
        console.error('Export failed:', error);
        window.$message?.error(`ÂØºÂá∫Â§±Ë¥•Ôºö${error.message}`);
    }
};

// Ëé∑ÂèñÁªÑ‰ª∂Ê†∑Âºè
const getComponentStyles = () => {
    // ‰ªé componentConfigs ‰∏≠ÊèêÂèñÊâÄÊúâÁªÑ‰ª∂ÁöÑÂü∫Á°ÄÊ†∑Âºè
    return Object.values(componentConfigs)
        .map(config => config.defaultStyle)
        .filter(Boolean)
        .map(style => styleObjectToCss(style))
        .join('\n');
};

// Ê†∑ÂºèÂØπË±°ËΩ¨CSS
const styleObjectToCss = (styleObj) => {
    return Object.entries(styleObj)
        .map(([key, value]) => `${key}: ${value};`)
        .join('\n');
};

// Ê∑ªÂä†ÁªÑ‰ª∂ÈÄâÊã©Â§ÑÁêÜÂáΩÊï∞
const handleComponentSelect = (componentId) => {
    // ‰ªé pageComponents ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑÁªÑ‰ª∂
    selectedComponent.value = pageComponents.value.find(
        comp => comp.id === componentId
    );
};

</script>

<style scoped>
/* Âè™‰øùÁïôÁâπÂÆöÁöÑÁºñËæëÂô®Â∏ÉÂ±ÄÊ†∑Âºè */
.editor-workspace {
    position: relative;
    flex: 1;
    width: 100%;
    min-height: 0;
    overflow: auto;
    display: flex;
    justify-content: center;
    align-items: center;
    background-image: linear-gradient(45deg, #80808010 25%, transparent 25%),
        linear-gradient(-45deg, #80808010 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #80808010 75%),
        linear-gradient(-45deg, transparent 75%, #80808010 75%);
    background-size: 20px 20px;
    background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
    cursor: default;
}

/* È¢ÑËßàÊ°ÜÊû∂ÁâπÂÆöÊ†∑Âºè */
.preview-frame {
    width: 100%;
    height: 100%;
    border: none;
    background: white;
    border-radius: 4px;
}

/* Â∑•ÂÖ∑Ê†èÂàÜÈöîÁ¨¶ */
.toolbar-separator {
    width: 1px;
    height: 24px;
    background: var(--cc-border-color);
    margin: 0 8px;
}

/* Áº©ÊîæÊéßÂà∂ÁâπÂÆöÊ†∑Âºè */
.zoom-value {
    padding: 0 8px;
    font-size: 13px;
    min-width: 60px;
    text-align: center;
}

/* ËäÇÁÇπÊìç‰ΩúÊåâÈíÆ */
.node-actions {
    opacity: 0;
    transition: opacity 0.2s;
}

.component-tree-node:hover .node-actions {
    opacity: 1;
}

/* Âà†Èô§ÊåâÈíÆÁâπÂÆöÊ†∑Âºè */
.delete-btn {
    padding: 2px;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--cc-theme-error);
}

.delete-btn:hover {
    background: rgba(255, 0, 0, 0.1);
}

/* ÁºñËæëÂô®‰∏ªÂå∫ÂüüÁâπÂÆöÂ∏ÉÂ±Ä */
.editor-main {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    min-height: 0;
}

/* ÁºñËæëÂô®Â∑•ÂÖ∑Ê†èÁâπÂÆöÂ∏ÉÂ±Ä */
.editor-toolbar {
    height: 48px;
    padding: 0 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
}

/* ÁºñËæëÂô®ÂÜÖÂÆπÂå∫ÂüüÊ†∑Âºè */
.editor-content-full {
    width: 100%;
    height: 100%;
    position: relative;
}
</style>