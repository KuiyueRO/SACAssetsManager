# 本区快由开发者编写,未经允许禁止AI助手更改

你需要时刻注意哪些内容应该位于shared,哪些内容位于toolBox,toolBox中的工具不应该对插件实例等有直接的依赖

# 共享资源重构笔记

## 重构状态

共享资源正在重构中，计划将其迁移到`src/shared`目录，并优化组织结构。

## 职责范围

- 提供跨模块复用组件
- 维护共享UI资源
- 管理通用工具和资源
- 确保一致的用户体验

## 重构原则

1. **资源整合**：
   - 收集分散在各处的共享资源
   - 按功能域归类整理
   - 清理冗余和过时资源

2. **接口标准化**：
   - 统一API设计风格
   - 规范命名约定
   - 明确组件和函数契约

3. **依赖简化**：
   - 减少外部依赖数量
   - 清晰管理依赖关系
   - 避免循环依赖问题

4. **渐进式迁移**：
   - 保持向后兼容性
   - 逐步更新调用点
   - 提供过渡期适配器

## 迁移计划

### 第一阶段：基础UI组件（进行中）

- 按钮、输入框等基础控件
- 对话框和消息提示组件
- 布局组件和容器

### 第二阶段：特定功能组件（计划中）

- 编辑器相关组件
- 数据展示组件
- 特殊交互组件

### 第三阶段：工具和资源（计划中）

- 图标和视觉资源
- 主题和样式资源
- 通用配置和常量

## 目录迁移映射

| 现有目录/文件 | 目标位置 | 优先级 | 状态 | 备注 |
|--------------|---------|-------|------|------|
| siyuanUI-vue/ | src/shared/components | 高 | 进行中 | Vue组件库 |

## 特殊处理说明

### 组件版本管理

共享组件的版本管理需要特别关注：

1. 实现版本兼容性检查机制
2. 对组件API变更进行记录
3. 支持多版本并存过渡
4. 提供升级迁移指南

### 跨框架兼容

考虑到不同技术栈的需求：

1. 将核心逻辑与UI框架分离
2. 提供不同框架的绑定版本
3. 使用抽象接口支持不同实现
4. 考虑Web Components作为长期方案

### 主题和样式处理

统一样式管理以确保一致性：

1. 使用CSS变量实现主题切换
2. 集中管理样式定义
3. 提供样式覆盖机制
4. 统一组件尺寸和布局规范

## 测试策略

1. **单元测试**：
   - 为每个组件编写单元测试
   - 测试不同配置和边界情况
   - 验证组件行为和交互

2. **集成测试**：
   - 测试组件在真实场景中的表现
   - 验证组件间的组合使用
   - 测试主题和样式应用效果

3. **视觉回归测试**：
   - 捕获组件渲染快照
   - 比较改动前后的视觉差异
   - 确保UI变更的连续性

## 文档要求

为共享资源提供全面的文档：

1. 资源目录和组织结构说明
2. 组件API文档和使用示例
3. 设计原则和最佳实践
4. 常见问题和解决方案
5. 迁移和升级指南

## 重构日志

| 日期 | 工作内容 | 状态 | 负责人 |
|------|---------|------|-------|
| 2023-12-15 | 共享资源模块规划 | 完成 | 团队 |
| 2024-01-10 | Vue组件库迁移规划 | 进行中 | AI助手 |
| 2024-01-25 | 基础UI组件迁移 | 待开始 | 团队 |

## 性能优化重点

1. **按需加载**：
   - 组件和资源支持按需导入
   - 减少初始加载资源大小
   - 实现资源懒加载机制

2. **渲染优化**：
   - 减少不必要的重渲染
   - 优化组件内部实现
   - 使用虚拟列表等性能模式

3. **资源精简**：
   - 优化资源文件大小
   - 移除未使用的功能
   - 合并相似功能实现

## 可访问性要求

共享组件需符合无障碍标准：

1. 支持键盘导航和操作
2. 兼容屏幕阅读器
3. 符合WCAG标准
4. 提供足够的颜色对比度

## 注意事项

- 修改共享资源时需考虑影响范围，谨慎处理
- 避免为特定场景定制共享组件，可考虑使用组合模式
- 定期评估和清理不再使用的共享资源
- 优先使用纯函数实现无状态组件
- 为复杂组件提供简化版本和高级版本 