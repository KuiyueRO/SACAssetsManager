/* esm.sh - radix3@1.1.2 */
var d={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function x(e={}){let i={options:e,rootNode:m(),staticRoutesMap:{}},n=r=>e.strictTrailingSlash?r:r.replace(/\/$/,"")||"/";if(e.routes)for(let r in e.routes)h(i,n(r),e.routes[r]);return{ctx:i,lookup:r=>D(i,n(r)),insert:(r,a)=>h(i,n(r),a),remove:r=>L(i,n(r))}}function D(e,i){let n=e.staticRoutesMap[i];if(n)return n.data;let r=i.split("/"),a={},t=!1,o=null,l=e.rootNode,s=null;for(let c=0;c<r.length;c++){let u=r[c];l.wildcardChildNode!==null&&(o=l.wildcardChildNode,s=r.slice(c).join("/"));let f=l.children.get(u);if(f===void 0){if(l&&l.placeholderChildren.length>1){let w=r.length-c;l=l.placeholderChildren.find(y=>y.maxDepth===w)||null}else l=l.placeholderChildren[0]||null;if(!l)break;l.paramName&&(a[l.paramName]=u),t=!0}else l=f}return(l===null||l.data===null)&&o!==null&&(l=o,a[l.paramName||"_"]=s,t=!0),l?t?{...l.data,params:t?a:void 0}:l.data:null}function h(e,i,n){let r=!0,a=i.split("/"),t=e.rootNode,o=0,l=[t];for(let s of a){let c;if(c=t.children.get(s))t=c;else{let u=O(s);c=m({type:u,parent:t}),t.children.set(s,c),u===d.PLACEHOLDER?(c.paramName=s==="*"?`_${o++}`:s.slice(1),t.placeholderChildren.push(c),r=!1):u===d.WILDCARD&&(t.wildcardChildNode=c,c.paramName=s.slice(3)||"_",r=!1),l.push(c),t=c}}for(let[s,c]of l.entries())c.maxDepth=Math.max(l.length-s,c.maxDepth||0);return t.data=n,r===!0&&(e.staticRoutesMap[i]=t),t}function L(e,i){let n=!1,r=i.split("/"),a=e.rootNode;for(let t of r)if(a=a.children.get(t),!a)return n;if(a.data){let t=r.at(-1)||"";a.data=null,Object.keys(a.children).length===0&&a.parent&&(a.parent.children.delete(t),a.parent.wildcardChildNode=null,a.parent.placeholderChildren=[]),n=!0}return n}function m(e={}){return{type:e.type||d.NORMAL,maxDepth:0,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function O(e){return e.startsWith("**")?d.WILDCARD:e[0]===":"||e==="*"?d.PLACEHOLDER:d.NORMAL}function A(e){let i=g("",e.ctx.rootNode);return N(i,e.ctx.options.strictTrailingSlash)}function N(e,i){return{ctx:{table:e},matchAll:n=>M(n,e,i)}}function b(){return{static:new Map,wildcard:new Map,dynamic:new Map}}function R(e){let i=Object.create(null);for(let n in e)i[n]=Object.fromEntries(n==="dynamic"?[...e[n].entries()].map(([r,a])=>[r,R(a)]):e[n].entries());return i}function _(e){return R(e.ctx.table)}function C(e){let i={};for(let n in e)i[n]=n==="dynamic"?new Map(Object.entries(e[n]).map(([r,a])=>[r,C(a)])):new Map(Object.entries(e[n]));return i}function E(e){return N(C(e))}function M(e,i,n){n!==!0&&e.endsWith("/")&&(e=e.slice(0,-1)||"/");let r=[];for(let[t,o]of p(i.wildcard))(e===t||e.startsWith(t+"/"))&&r.push(o);for(let[t,o]of p(i.dynamic))if(e.startsWith(t+"/")){let l="/"+e.slice(t.length).split("/").splice(2).join("/");r.push(...M(l,o))}let a=i.static.get(e);return a&&r.push(a),r.filter(Boolean)}function p(e){return[...e.entries()].sort((i,n)=>i[0].length-n[0].length)}function g(e,i){let n=b();function r(a,t){if(a){if(t.type===d.NORMAL&&!(a.includes("*")||a.includes(":")))t.data&&n.static.set(a,t.data);else if(t.type===d.WILDCARD)n.wildcard.set(a.replace("/**",""),t.data);else if(t.type===d.PLACEHOLDER){let o=g("",t);t.data&&o.static.set("/",t.data),n.dynamic.set(a.replace(/\/\*|\/:\w+/,""),o);return}}for(let[o,l]of t.children.entries())r(`${a}/${o}`.replace("//","/"),l)}return r(e,i),n}export{d as NODE_TYPES,E as createMatcherFromExport,x as createRouter,_ as exportMatcher,A as toRouteMatcher};
//# sourceMappingURL=radix3.mjs.map