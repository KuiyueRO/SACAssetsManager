/* esm.sh - esbuild bundle(vue-konva@3.1.2) es2022 production */
import * as __0$ from "./konva.js";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({__esModule:true},m);switch(n){case"konva":return c(__0$);default:throw new Error("module \""+n+"\" not found");}};
var O=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(n,r)=>(typeof require<"u"?require:n)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});import{defineComponent as k,getCurrentInstance as L,reactive as N,ref as E,onMounted as S,onUpdated as b,onBeforeUnmount as M,watch as T,h as P,onUnmounted as R}from"./vue.esm-browser.js";import s from"./konva.js";function m(t){if(!s.autoDrawEnabled){let n=t.getLayer()||t.getStage();n&&n.batchDraw()}}var w={key:!0,style:!0,elm:!0,isRootInsert:!0},h=".vue-konva-event";function x(t,n,r,l){let e=t.__konvaNode,u={},a=!1;for(let o in r){if(w.hasOwnProperty(o))continue;let c=o.slice(0,2)==="on",p=r[o]!==n[o];if(c&&p){let i=o.slice(2).toLowerCase();i.slice(0,7)==="content"&&(i="content"+i.slice(7,1).toUpperCase()+i.slice(8)),e?.off(i+h,r[o])}!n.hasOwnProperty(o)&&e?.setAttr(o,void 0)}for(let o in n){if(w.hasOwnProperty(o))continue;let c=o.slice(0,2)==="on",p=r[o]!==n[o];if(c&&p){let i=o.slice(2).toLowerCase();i.slice(0,7)==="content"&&(i="content"+i.slice(7,1).toUpperCase()+i.slice(8)),n[o]&&(e?.off(i+h),e?.on(i+h,n[o]))}!c&&(n[o]!==r[o]||l&&n[o]!==e?.getAttr(o))&&(a=!0,u[o]=n[o])}a&&e&&(e.setAttrs(u),m(e))}var I="v";function j(t){function n(r){return r!=null&&r.__konvaNode?r:r!=null&&r.parent?n(r.parent):(console.error("vue-konva error: Can not find parent node"),null)}return n(t.parent)}function A(t){return t.component?t.component.__konvaNode||A(t.component.subTree):null}function U(t){let{el:n,component:r}=t,l=A(t);if(n!=null&&n.tagName&&r&&!l){let e=n.tagName.toLowerCase();return console.error(`vue-konva error: You are trying to render "${e}" inside your component tree. Looks like it is not a Konva node. You can render only Konva components inside the Stage.`),null}return l}function F(t){let n=e=>!!(e!=null&&e.hasOwnProperty("component")),r=e=>Array.isArray(e),l=e=>n(e)?[e,...l(e.children)]:r(e)?e.flatMap(l):[];return l(t.children)}function C(t,n){let r=F(t),l=[];r.forEach(u=>{let a=U(u);a&&l.push(a)});let e=!1;l.forEach((u,a)=>{u.getZIndex()!==a&&(u.setZIndex(a),e=!0)}),e&&m(n)}var G=k({name:"Stage",props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},inheritAttrs:!1,setup(t,{attrs:n,slots:r,expose:l}){let e=L();if(!e)return;let u=N({}),a=E(null),o=new s.Stage({width:t.config.width,height:t.config.height,container:document.createElement("div")});e.__konvaNode=o,i();function c(){return e?.__konvaNode}function p(){return e?.__konvaNode}function i(){if(!e)return;let d=u||{},g={...n,...t.config};x(e,g,d,t.__useStrictMode),Object.assign(u,g)}return S(()=>{a.value&&(a.value.innerHTML="",o.container(a.value)),i()}),b(()=>{i(),C(e.subTree,o)}),M(()=>{o.destroy()}),T(()=>t.config,i,{deep:!0}),l({getStage:p,getNode:c}),()=>{var d;return P("div",{ref:a},(d=r.default)==null?void 0:d.call(r))}}}),K=".vue-konva-event",B={Group:!0,Layer:!0,FastLayer:!0,Label:!0};function D(t,n){return k({name:t,props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},setup(r,{attrs:l,slots:e,expose:u}){let a=L();if(!a)return;let o=N({}),c=new n;a.__konvaNode=c,a.vnode.__konvaNode=c,d();function p(){return a?.__konvaNode}function i(){return a?.__konvaNode}function d(){if(!a)return;let f={};for(let _ in a?.vnode.props)_.slice(0,2)==="on"&&(f[_]=a.vnode.props[_]);let v=o||{},y={...l,...r.config,...f};x(a,y,v,r.__useStrictMode),Object.assign(o,y)}S(()=>{var f;let v=(f=j(a))==null?void 0:f.__konvaNode;v&&"add"in v&&v.add(c),m(c)}),R(()=>{m(c),c.destroy(),c.off(K)}),b(()=>{d(),C(a.subTree,c)}),T(()=>r.config,d,{deep:!0}),u({getStage:i,getNode:p});let g=B.hasOwnProperty(t);return()=>{var f;return g?P("template",{},(f=e.default)==null?void 0:f.call(e)):null}}})}typeof window<"u"&&!window.Konva&&O("konva");var Z={install:(t,n)=>{let r=n?.prefix||I,l={Arc:s.Arc,Arrow:s.Arrow,Circle:s.Circle,Ellipse:s.Ellipse,FastLayer:s.FastLayer,Group:s.Group,Image:s.Image,Label:s.Label,Layer:s.Layer,Line:s.Line,Path:s.Path,Rect:s.Rect,RegularPolygon:s.RegularPolygon,Ring:s.Ring,Shape:s.Shape,Sprite:s.Sprite,Star:s.Star,Tag:s.Tag,Text:s.Text,TextPath:s.TextPath,Transformer:s.Transformer,Wedge:s.Wedge,...n?.customNodes};[G,...Object.entries(l).map(([e,u])=>D(e,u))].forEach(e=>{t.component(`${r}${e.name}`,e)})}};export{Z as default};
//# sourceMappingURL=vue-konva.js.map