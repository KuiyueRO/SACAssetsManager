/* esm.sh - esbuild bundle(three@0.169.0/examples/jsm/loaders/TGALoader) es2022 production */
import{DataTextureLoader as Q,LinearMipmapLinearFilter as V}from"../../../three.mjs";var N=class extends Q{constructor(a){super(a)}parse(a){function Y(e){switch(e.image_type){case A:case R:if(e.colormap_length>256||e.colormap_size!==24||e.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case b:case I:case k:case L:if(e.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case C:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+e.image_type)}if(e.width<=0||e.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(e.pixel_size!==8&&e.pixel_size!==16&&e.pixel_size!==24&&e.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+e.pixel_size)}function P(e,x,_,l,u){let i,c,s=_.pixel_size>>3,n=_.width*_.height*s;if(x&&(c=u.subarray(l,l+=_.colormap_length*(_.colormap_size>>3))),e){i=new Uint8Array(n);let r,t,o,p=0,G=new Uint8Array(s);for(;p<n;)if(r=u[l++],t=(r&127)+1,r&128){for(o=0;o<s;++o)G[o]=u[l++];for(o=0;o<t;++o)i.set(G,p+o*s);p+=s*t}else{for(t*=s,o=0;o<t;++o)i[p+o]=u[l++];p+=t}}else i=u.subarray(l,l+=x?_.width*_.height:n);return{pixel_data:i,palettes:c}}function O(e,x,_,l,u,i,c,s,n){let r=n,t,o=0,p,G,f=E.width;for(G=x;G!==l;G+=_)for(p=u;p!==c;p+=i,o++)t=s[o],e[(p+f*G)*4+3]=255,e[(p+f*G)*4+2]=r[t*3+0],e[(p+f*G)*4+1]=r[t*3+1],e[(p+f*G)*4+0]=r[t*3+2];return e}function F(e,x,_,l,u,i,c,s){let n,r=0,t,o,p=E.width;for(o=x;o!==l;o+=_)for(t=u;t!==c;t+=i,r+=2)n=s[r+0]+(s[r+1]<<8),e[(t+p*o)*4+0]=(n&31744)>>7,e[(t+p*o)*4+1]=(n&992)>>2,e[(t+p*o)*4+2]=(n&31)<<3,e[(t+p*o)*4+3]=n&32768?0:255;return e}function U(e,x,_,l,u,i,c,s){let n=0,r,t,o=E.width;for(t=x;t!==l;t+=_)for(r=u;r!==c;r+=i,n+=3)e[(r+o*t)*4+3]=255,e[(r+o*t)*4+2]=s[n+0],e[(r+o*t)*4+1]=s[n+1],e[(r+o*t)*4+0]=s[n+2];return e}function v(e,x,_,l,u,i,c,s){let n=0,r,t,o=E.width;for(t=x;t!==l;t+=_)for(r=u;r!==c;r+=i,n+=4)e[(r+o*t)*4+2]=s[n+0],e[(r+o*t)*4+1]=s[n+1],e[(r+o*t)*4+0]=s[n+2],e[(r+o*t)*4+3]=s[n+3];return e}function B(e,x,_,l,u,i,c,s){let n,r=0,t,o,p=E.width;for(o=x;o!==l;o+=_)for(t=u;t!==c;t+=i,r++)n=s[r],e[(t+p*o)*4+0]=n,e[(t+p*o)*4+1]=n,e[(t+p*o)*4+2]=n,e[(t+p*o)*4+3]=255;return e}function g(e,x,_,l,u,i,c,s){let n=0,r,t,o=E.width;for(t=x;t!==l;t+=_)for(r=u;r!==c;r+=i,n+=2)e[(r+o*t)*4+0]=s[n+0],e[(r+o*t)*4+1]=s[n+0],e[(r+o*t)*4+2]=s[n+0],e[(r+o*t)*4+3]=s[n+1];return e}function M(e,x,_,l,u){let i,c,s,n,r,t;switch((E.flags&S)>>X){default:case q:i=0,s=1,r=x,c=0,n=1,t=_;break;case K:i=0,s=1,r=x,c=_-1,n=-1,t=-1;break;case J:i=x-1,s=-1,r=-1,c=0,n=1,t=_;break;case j:i=x-1,s=-1,r=-1,c=_-1,n=-1,t=-1;break}if(y)switch(E.pixel_size){case 8:B(e,c,n,t,i,s,r,l);break;case 16:g(e,c,n,t,i,s,r,l);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(E.pixel_size){case 8:O(e,c,n,t,i,s,r,l,u);break;case 16:F(e,c,n,t,i,s,r,l);break;case 24:U(e,c,n,t,i,s,r,l);break;case 32:v(e,c,n,t,i,s,r,l);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return e}let C=0,A=1,b=2,I=3,R=9,k=10,L=11,S=48,X=4,K=0,j=1,q=2,J=3;if(a.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let w=0,T=new Uint8Array(a),E={id_length:T[w++],colormap_type:T[w++],image_type:T[w++],colormap_index:T[w++]|T[w++]<<8,colormap_length:T[w++]|T[w++]<<8,colormap_size:T[w++],origin:[T[w++]|T[w++]<<8,T[w++]|T[w++]<<8],width:T[w++]|T[w++]<<8,height:T[w++]|T[w++]<<8,pixel_size:T[w++],flags:T[w++]};if(Y(E),E.id_length+w>a.length)throw new Error("THREE.TGALoader: No data.");w+=E.id_length;let h=!1,d=!1,y=!1;switch(E.image_type){case R:h=!0,d=!0;break;case A:d=!0;break;case k:h=!0;break;case b:break;case L:h=!0,y=!0;break;case I:y=!0;break}let z=new Uint8Array(E.width*E.height*4),H=P(h,d,E,w,T);return M(z,E.width,E.height,H.pixel_data,H.palettes),{data:z,width:E.width,height:E.height,flipY:!0,generateMipmaps:!0,minFilter:V}}};export{N as TGALoader};
//# sourceMappingURL=TGALoader.js.map