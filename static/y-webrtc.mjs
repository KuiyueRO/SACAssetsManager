/* esm.sh - y-webrtc@10.3.0 */
import __Process$ from "./node_process.js";
import { Buffer as __Buffer$ } from "./buffer.js";
var xn=Object.create;var br=Object.defineProperty;var Sn=Object.getOwnPropertyDescriptor;var Cn=Object.getOwnPropertyNames;var Tn=Object.getPrototypeOf,Rn=Object.prototype.hasOwnProperty;var Zt=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(o,s)=>(typeof require<"u"?require:o)[s]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var An=(r,o)=>()=>(o||r((o={exports:{}}).exports,o),o.exports);var Un=(r,o,s,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let m of Cn(o))!Rn.call(r,m)&&m!==s&&br(r,m,{get:()=>o[m],enumerable:!(c=Sn(o,m))||c.enumerable});return r};var kn=(r,o,s)=>(s=r!=null?xn(Tn(r)):{},Un(o||!r||!r.__esModule?br(s,"default",{value:r,enumerable:!0}):s,r));var an=An((sn,or)=>{(function(r){if(typeof sn=="object"&&typeof or<"u")or.exports=r();else if(typeof define=="function"&&define.amd)define([],r);else{var o;o=typeof window>"u"?typeof globalThis>"u"?typeof self>"u"?this:self:globalThis:window,o.SimplePeer=r()}})(function(){var r=Math.floor,o=Math.abs,s=Math.pow;return function(){function c(m,p,a){function _(g,y){if(!p[g]){if(!m[g]){var u=typeof Zt=="function"&&Zt;if(!y&&u)return u(g,!0);if(A)return A(g,!0);var x=new Error("Cannot find module '"+g+"'");throw x.code="MODULE_NOT_FOUND",x}var C=p[g]={exports:{}};m[g][0].call(C.exports,function(k){var O=m[g][1][k];return _(O||k)},C,C.exports,c,m,p,a)}return p[g].exports}for(var A=typeof Zt=="function"&&Zt,i=0;i<a.length;i++)_(a[i]);return _}return c}()({1:[function(c,m,p){"use strict";function a(f){var d=f.length;if(0<d%4)throw new Error("Invalid string. Length must be a multiple of 4");var v=f.indexOf("=");v===-1&&(v=d);var b=v===d?0:4-v%4;return[v,b]}function _(f,d,v){return 3*(d+v)/4-v}function A(f){var d,v,b=a(f),T=b[0],N=b[1],w=new C(_(f,T,N)),E=0,I=0<N?T-4:T;for(v=0;v<I;v+=4)d=x[f.charCodeAt(v)]<<18|x[f.charCodeAt(v+1)]<<12|x[f.charCodeAt(v+2)]<<6|x[f.charCodeAt(v+3)],w[E++]=255&d>>16,w[E++]=255&d>>8,w[E++]=255&d;return N===2&&(d=x[f.charCodeAt(v)]<<2|x[f.charCodeAt(v+1)]>>4,w[E++]=255&d),N===1&&(d=x[f.charCodeAt(v)]<<10|x[f.charCodeAt(v+1)]<<4|x[f.charCodeAt(v+2)]>>2,w[E++]=255&d>>8,w[E++]=255&d),w}function i(f){return u[63&f>>18]+u[63&f>>12]+u[63&f>>6]+u[63&f]}function g(f,d,v){for(var b,T=[],N=d;N<v;N+=3)b=(16711680&f[N]<<16)+(65280&f[N+1]<<8)+(255&f[N+2]),T.push(i(b));return T.join("")}function y(f){for(var d,v=f.length,b=v%3,T=[],N=16383,w=0,E=v-b;w<E;w+=N)T.push(g(f,w,w+N>E?E:w+N));return b===1?(d=f[v-1],T.push(u[d>>2]+u[63&d<<4]+"==")):b===2&&(d=(f[v-2]<<8)+f[v-1],T.push(u[d>>10]+u[63&d>>4]+u[63&d<<2]+"=")),T.join("")}p.byteLength=function(f){var d=a(f),v=d[0],b=d[1];return 3*(v+b)/4-b},p.toByteArray=A,p.fromByteArray=y;for(var u=[],x=[],C=typeof Uint8Array>"u"?Array:Uint8Array,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O=0,l=k.length;O<l;++O)u[O]=k[O],x[k.charCodeAt(O)]=O;x[45]=62,x[95]=63},{}],2:[function(){},{}],3:[function(c,m,p){(function(){(function(){"use strict";var a=String.fromCharCode,_=Math.min;function A(t){if(2147483647<t)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=i.prototype,e}function i(t,e,n){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(t)}return g(t,e,n)}function g(t,e,n){if(typeof t=="string")return C(t,e);if(ArrayBuffer.isView(t))return k(t);if(t==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(S(t,ArrayBuffer)||t&&S(t.buffer,ArrayBuffer))return O(t,e,n);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var h=t.valueOf&&t.valueOf();if(h!=null&&h!==t)return i.from(h,e,n);var R=l(t);if(R)return R;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return i.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function y(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(0>t)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t,e,n){return y(t),0>=t||e===void 0?A(t):typeof n=="string"?A(t).fill(e,n):A(t).fill(e)}function x(t){return y(t),A(0>t?0:0|f(t))}function C(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|d(t,e),h=A(n),R=h.write(t,e);return R!==n&&(h=h.slice(0,R)),h}function k(t){for(var e=0>t.length?0:0|f(t.length),n=A(e),h=0;h<e;h+=1)n[h]=255&t[h];return n}function O(t,e,n){if(0>e||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var h;return h=e===void 0&&n===void 0?new Uint8Array(t):n===void 0?new Uint8Array(t,e):new Uint8Array(t,e,n),h.__proto__=i.prototype,h}function l(t){if(i.isBuffer(t)){var e=0|f(t.length),n=A(e);return n.length===0||t.copy(n,0,0,e),n}return t.length===void 0?t.type==="Buffer"&&Array.isArray(t.data)?k(t.data):void 0:typeof t.length!="number"||L(t.length)?A(0):k(t)}function f(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function d(t,e){if(i.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||S(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,h=2<arguments.length&&arguments[2]===!0;if(!h&&n===0)return 0;for(var R=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return bt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return nt(t).length;default:if(R)return h?-1:bt(t).length;e=(""+e).toLowerCase(),R=!0}}function v(t,e,n){var h=!1;if((e===void 0||0>e)&&(e=0),e>this.length||((n===void 0||n>this.length)&&(n=this.length),0>=n)||(n>>>=0,e>>>=0,n<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return Et(this,e,n);case"utf8":case"utf-8":return Z(this,e,n);case"ascii":return F(this,e,n);case"latin1":case"binary":return ce(this,e,n);case"base64":return H(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yt(this,e,n);default:if(h)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),h=!0}}function b(t,e,n){var h=t[e];t[e]=t[n],t[n]=h}function T(t,e,n,h,R){if(t.length===0)return-1;if(typeof n=="string"?(h=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,L(n)&&(n=R?0:t.length-1),0>n&&(n=t.length+n),n>=t.length){if(R)return-1;n=t.length-1}else if(0>n)if(R)n=0;else return-1;if(typeof e=="string"&&(e=i.from(e,h)),i.isBuffer(e))return e.length===0?-1:N(t,e,n,h,R);if(typeof e=="number")return e&=255,typeof Uint8Array.prototype.indexOf=="function"?R?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):N(t,[e],n,h,R);throw new TypeError("val must be string, number or Buffer")}function N(t,e,n,h,R){function U(Xt,Bt){return D===1?Xt[Bt]:Xt.readUInt16BE(Bt*D)}var D=1,W=t.length,X=e.length;if(h!==void 0&&(h=(h+"").toLowerCase(),h==="ucs2"||h==="ucs-2"||h==="utf16le"||h==="utf-16le")){if(2>t.length||2>e.length)return-1;D=2,W/=2,X/=2,n/=2}var z;if(R){var Y=-1;for(z=n;z<W;z++)if(U(t,z)!==U(e,Y===-1?0:z-Y))Y!==-1&&(z-=z-Y),Y=-1;else if(Y===-1&&(Y=z),z-Y+1===X)return Y*D}else for(n+X>W&&(n=W-X),z=n;0<=z;z--){for(var G=!0,It=0;It<X;It++)if(U(t,z+It)!==U(e,It)){G=!1;break}if(G)return z}return-1}function w(t,e,n,h){n=+n||0;var R=t.length-n;h?(h=+h,h>R&&(h=R)):h=R;var U=e.length;h>U/2&&(h=U/2);for(var D,W=0;W<h;++W){if(D=parseInt(e.substr(2*W,2),16),L(D))return W;t[n+W]=D}return W}function E(t,e,n,h){return ht(bt(e,t.length-n),t,n,h)}function I(t,e,n,h){return ht(Kt(e),t,n,h)}function M(t,e,n,h){return I(t,e,n,h)}function j(t,e,n,h){return ht(nt(e),t,n,h)}function V(t,e,n,h){return ht(Jt(e,t.length-n),t,n,h)}function H(t,e,n){return e===0&&n===t.length?B.fromByteArray(t):B.fromByteArray(t.slice(e,n))}function Z(t,e,n){n=_(t.length,n);for(var h=[],R=e;R<n;){var U=t[R],D=null,W=239<U?4:223<U?3:191<U?2:1;if(R+W<=n){var X,z,Y,G;W===1?128>U&&(D=U):W===2?(X=t[R+1],(192&X)==128&&(G=(31&U)<<6|63&X,127<G&&(D=G))):W===3?(X=t[R+1],z=t[R+2],(192&X)==128&&(192&z)==128&&(G=(15&U)<<12|(63&X)<<6|63&z,2047<G&&(55296>G||57343<G)&&(D=G))):W===4&&(X=t[R+1],z=t[R+2],Y=t[R+3],(192&X)==128&&(192&z)==128&&(192&Y)==128&&(G=(15&U)<<18|(63&X)<<12|(63&z)<<6|63&Y,65535<G&&1114112>G&&(D=G)))}D===null?(D=65533,W=1):65535<D&&(D-=65536,h.push(55296|1023&D>>>10),D=56320|1023&D),h.push(D),R+=W}return rt(h)}function rt(t){var e=t.length;if(e<=4096)return a.apply(String,t);for(var n="",h=0;h<e;)n+=a.apply(String,t.slice(h,h+=4096));return n}function F(t,e,n){var h="";n=_(t.length,n);for(var R=e;R<n;++R)h+=a(127&t[R]);return h}function ce(t,e,n){var h="";n=_(t.length,n);for(var R=e;R<n;++R)h+=a(t[R]);return h}function Et(t,e,n){var h=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>h)&&(n=h);for(var R="",U=e;U<n;++U)R+=$t(t[U]);return R}function yt(t,e,n){for(var h=t.slice(e,n),R="",U=0;U<h.length;U+=2)R+=a(h[U]+256*h[U+1]);return R}function K(t,e,n){if(t%1!=0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function J(t,e,n,h,R,U){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>R||e<U)throw new RangeError('"value" argument is out of bounds');if(n+h>t.length)throw new RangeError("Index out of range")}function xt(t,e,n,h){if(n+h>t.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function ut(t,e,n,h,R){return e=+e,n>>>=0,R||xt(t,e,n,4,34028234663852886e22,-34028234663852886e22),P.write(t,e,n,h,23,4),n+4}function St(t,e,n,h,R){return e=+e,n>>>=0,R||xt(t,e,n,8,17976931348623157e292,-17976931348623157e292),P.write(t,e,n,h,52,8),n+8}function Rt(t){if(t=t.split("=")[0],t=t.trim().replace(q,""),2>t.length)return"";for(;t.length%4!=0;)t+="=";return t}function $t(t){return 16>t?"0"+t.toString(16):t.toString(16)}function bt(t,e){e=e||1/0;for(var n,h=t.length,R=null,U=[],D=0;D<h;++D){if(n=t.charCodeAt(D),55295<n&&57344>n){if(!R){if(56319<n){-1<(e-=3)&&U.push(239,191,189);continue}else if(D+1===h){-1<(e-=3)&&U.push(239,191,189);continue}R=n;continue}if(56320>n){-1<(e-=3)&&U.push(239,191,189),R=n;continue}n=(R-55296<<10|n-56320)+65536}else R&&-1<(e-=3)&&U.push(239,191,189);if(R=null,128>n){if(0>(e-=1))break;U.push(n)}else if(2048>n){if(0>(e-=2))break;U.push(192|n>>6,128|63&n)}else if(65536>n){if(0>(e-=3))break;U.push(224|n>>12,128|63&n>>6,128|63&n)}else if(1114112>n){if(0>(e-=4))break;U.push(240|n>>18,128|63&n>>12,128|63&n>>6,128|63&n)}else throw new Error("Invalid code point")}return U}function Kt(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function Jt(t,e){for(var n,h,R,U=[],D=0;D<t.length&&!(0>(e-=2));++D)n=t.charCodeAt(D),h=n>>8,R=n%256,U.push(R),U.push(h);return U}function nt(t){return B.toByteArray(Rt(t))}function ht(t,e,n,h){for(var R=0;R<h&&!(R+n>=e.length||R>=t.length);++R)e[R+n]=t[R];return R}function S(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function L(t){return t!==t}var B=c("base64-js"),P=c("ieee754");p.Buffer=i,p.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},p.INSPECT_MAX_BYTES=50,p.kMaxLength=2147483647,i.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},t.foo()===42}catch{return!1}}(),i.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){return i.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){return i.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),i.poolSize=8192,i.from=function(t,e,n){return g(t,e,n)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function(t,e,n){return u(t,e,n)},i.allocUnsafe=function(t){return x(t)},i.allocUnsafeSlow=function(t){return x(t)},i.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==i.prototype},i.compare=function(t,e){if(S(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),S(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,h=e.length,R=0,U=_(n,h);R<U;++R)if(t[R]!==e[R]){n=t[R],h=e[R];break}return n<h?-1:h<n?1:0},i.isEncoding=function(t){switch((t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return i.alloc(0);var n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var h=i.allocUnsafe(e),R=0;for(n=0;n<t.length;++n){var U=t[n];if(S(U,Uint8Array)&&(U=i.from(U)),!i.isBuffer(U))throw new TypeError('"list" argument must be an Array of Buffers');U.copy(h,R),R+=U.length}return h},i.byteLength=d,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},i.prototype.toString=function(){var t=this.length;return t===0?"":arguments.length===0?Z(this,0,t):v.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||i.compare(this,t)===0},i.prototype.inspect=function(){var t="",e=p.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},i.prototype.compare=function(t,e,n,h,R){if(S(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),h===void 0&&(h=0),R===void 0&&(R=this.length),0>e||n>t.length||0>h||R>this.length)throw new RangeError("out of range index");if(h>=R&&e>=n)return 0;if(h>=R)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,h>>>=0,R>>>=0,this===t)return 0;for(var U=R-h,D=n-e,W=_(U,D),X=this.slice(h,R),z=t.slice(e,n),Y=0;Y<W;++Y)if(X[Y]!==z[Y]){U=X[Y],D=z[Y];break}return U<D?-1:D<U?1:0},i.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1},i.prototype.indexOf=function(t,e,n){return T(this,t,e,n,!0)},i.prototype.lastIndexOf=function(t,e,n){return T(this,t,e,n,!1)},i.prototype.write=function(t,e,n,h){if(e===void 0)h="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")h=e,n=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(n)?(n>>>=0,h===void 0&&(h="utf8")):(h=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var R=this.length-e;if((n===void 0||n>R)&&(n=R),0<t.length&&(0>n||0>e)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");h||(h="utf8");for(var U=!1;;)switch(h){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return E(this,t,e,n);case"ascii":return I(this,t,e,n);case"latin1":case"binary":return M(this,t,e,n);case"base64":return j(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,t,e,n);default:if(U)throw new TypeError("Unknown encoding: "+h);h=(""+h).toLowerCase(),U=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.slice=function(t,e){var n=this.length;t=~~t,e=e===void 0?n:~~e,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),e<t&&(e=t);var h=this.subarray(t,e);return h.__proto__=i.prototype,h},i.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||K(t,e,this.length);for(var h=this[t],R=1,U=0;++U<e&&(R*=256);)h+=this[t+U]*R;return h},i.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||K(t,e,this.length);for(var h=this[t+--e],R=1;0<e&&(R*=256);)h+=this[t+--e]*R;return h},i.prototype.readUInt8=function(t,e){return t>>>=0,e||K(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return t>>>=0,e||K(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return t>>>=0,e||K(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return t>>>=0,e||K(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return t>>>=0,e||K(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||K(t,e,this.length);for(var h=this[t],R=1,U=0;++U<e&&(R*=256);)h+=this[t+U]*R;return R*=128,h>=R&&(h-=s(2,8*e)),h},i.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||K(t,e,this.length);for(var h=e,R=1,U=this[t+--h];0<h&&(R*=256);)U+=this[t+--h]*R;return R*=128,U>=R&&(U-=s(2,8*e)),U},i.prototype.readInt8=function(t,e){return t>>>=0,e||K(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){t>>>=0,e||K(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(t,e){t>>>=0,e||K(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(t,e){return t>>>=0,e||K(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return t>>>=0,e||K(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return t>>>=0,e||K(t,4,this.length),P.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return t>>>=0,e||K(t,4,this.length),P.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return t>>>=0,e||K(t,8,this.length),P.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return t>>>=0,e||K(t,8,this.length),P.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,n,h){if(t=+t,e>>>=0,n>>>=0,!h){var R=s(2,8*n)-1;J(this,t,e,n,R,0)}var U=1,D=0;for(this[e]=255&t;++D<n&&(U*=256);)this[e+D]=255&t/U;return e+n},i.prototype.writeUIntBE=function(t,e,n,h){if(t=+t,e>>>=0,n>>>=0,!h){var R=s(2,8*n)-1;J(this,t,e,n,R,0)}var U=n-1,D=1;for(this[e+U]=255&t;0<=--U&&(D*=256);)this[e+U]=255&t/D;return e+n},i.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,1,255,0),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},i.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeIntLE=function(t,e,n,h){if(t=+t,e>>>=0,!h){var R=s(2,8*n-1);J(this,t,e,n,R-1,-R)}var U=0,D=1,W=0;for(this[e]=255&t;++U<n&&(D*=256);)0>t&&W===0&&this[e+U-1]!==0&&(W=1),this[e+U]=255&(t/D>>0)-W;return e+n},i.prototype.writeIntBE=function(t,e,n,h){if(t=+t,e>>>=0,!h){var R=s(2,8*n-1);J(this,t,e,n,R-1,-R)}var U=n-1,D=1,W=0;for(this[e+U]=255&t;0<=--U&&(D*=256);)0>t&&W===0&&this[e+U+1]!==0&&(W=1),this[e+U]=255&(t/D>>0)-W;return e+n},i.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,1,127,-128),0>t&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},i.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||J(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeFloatLE=function(t,e,n){return ut(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){return ut(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){return St(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){return St(this,t,e,!1,n)},i.prototype.copy=function(t,e,n,h){if(!i.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),h||h===0||(h=this.length),e>=t.length&&(e=t.length),e||(e=0),0<h&&h<n&&(h=n),h===n||t.length===0||this.length===0)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("Index out of range");if(0>h)throw new RangeError("sourceEnd out of bounds");h>this.length&&(h=this.length),t.length-e<h-n&&(h=t.length-e+n);var R=h-n;if(this===t&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(e,n,h);else if(this===t&&n<e&&e<h)for(var U=R-1;0<=U;--U)t[U+e]=this[U+n];else Uint8Array.prototype.set.call(t,this.subarray(n,h),e);return R},i.prototype.fill=function(t,e,n,h){if(typeof t=="string"){if(typeof e=="string"?(h=e,e=0,n=this.length):typeof n=="string"&&(h=n,n=this.length),h!==void 0&&typeof h!="string")throw new TypeError("encoding must be a string");if(typeof h=="string"&&!i.isEncoding(h))throw new TypeError("Unknown encoding: "+h);if(t.length===1){var R=t.charCodeAt(0);(h==="utf8"&&128>R||h==="latin1")&&(t=R)}}else typeof t=="number"&&(t&=255);if(0>e||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=n===void 0?this.length:n>>>0,t||(t=0);var U;if(typeof t=="number")for(U=e;U<n;++U)this[U]=t;else{var D=i.isBuffer(t)?t:i.from(t,h),W=D.length;if(W===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(U=0;U<n-e;++U)this[U+e]=D[U%W]}return this};var q=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,c("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(c,m,p){(function(a){(function(){function _(){let i;try{i=p.storage.getItem("debug")}catch{}return!i&&typeof a<"u"&&"env"in a&&(i=a.env.DEBUG),i}p.formatArgs=function(i){if(i[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+i[0]+(this.useColors?"%c ":" ")+"+"+m.exports.humanize(this.diff),!this.useColors)return;let g="color: "+this.color;i.splice(1,0,g,"color: inherit");let y=0,u=0;i[0].replace(/%[a-zA-Z%]/g,x=>{x==="%%"||(y++,x==="%c"&&(u=y))}),i.splice(u,0,g)},p.save=function(i){try{i?p.storage.setItem("debug",i):p.storage.removeItem("debug")}catch{}},p.load=_,p.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},p.storage=function(){try{return localStorage}catch{}}(),p.destroy=(()=>{let i=!1;return()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),p.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],p.log=console.debug||console.log||(()=>{}),m.exports=c("./common")(p);let{formatters:A}=m.exports;A.j=function(i){try{return JSON.stringify(i)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}}).call(this)}).call(this,c("_process"))},{"./common":5,_process:12}],5:[function(c,m){m.exports=function(p){function a(i){function g(...x){if(!g.enabled)return;let C=g,k=+new Date,O=k-(y||k);C.diff=O,C.prev=y,C.curr=k,y=k,x[0]=a.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let l=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(d,v)=>{if(d==="%%")return"%";l++;let b=a.formatters[v];if(typeof b=="function"){let T=x[l];d=b.call(C,T),x.splice(l,1),l--}return d}),a.formatArgs.call(C,x),(C.log||a.log).apply(C,x)}let y,u=null;return g.namespace=i,g.useColors=a.useColors(),g.color=a.selectColor(i),g.extend=_,g.destroy=a.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>u===null?a.enabled(i):u,set:x=>{u=x}}),typeof a.init=="function"&&a.init(g),g}function _(i,g){let y=a(this.namespace+(typeof g>"u"?":":g)+i);return y.log=this.log,y}function A(i){return i.toString().substring(2,i.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(i){return i instanceof Error?i.stack||i.message:i},a.disable=function(){let i=[...a.names.map(A),...a.skips.map(A).map(g=>"-"+g)].join(",");return a.enable(""),i},a.enable=function(i){a.save(i),a.names=[],a.skips=[];let g,y=(typeof i=="string"?i:"").split(/[\s,]+/),u=y.length;for(g=0;g<u;g++)y[g]&&(i=y[g].replace(/\*/g,".*?"),i[0]==="-"?a.skips.push(new RegExp("^"+i.substr(1)+"$")):a.names.push(new RegExp("^"+i+"$")))},a.enabled=function(i){if(i[i.length-1]==="*")return!0;let g,y;for(g=0,y=a.skips.length;g<y;g++)if(a.skips[g].test(i))return!1;for(g=0,y=a.names.length;g<y;g++)if(a.names[g].test(i))return!0;return!1},a.humanize=c("ms"),a.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(p).forEach(i=>{a[i]=p[i]}),a.names=[],a.skips=[],a.formatters={},a.selectColor=function(i){let g=0;for(let y=0;y<i.length;y++)g=(g<<5)-g+i.charCodeAt(y),g|=0;return a.colors[o(g)%a.colors.length]},a.enable(a.load()),a}},{ms:11}],6:[function(c,m){"use strict";function p(a,_){for(let A in _)Object.defineProperty(a,A,{value:_[A],enumerable:!0,configurable:!0});return a}m.exports=function(a,_,A){if(!a||typeof a=="string")throw new TypeError("Please pass an Error to err-code");A||(A={}),typeof _=="object"&&(A=_,_=""),_&&(A.code=_);try{return p(a,A)}catch{A.message=a.message,A.stack=a.stack;let g=function(){};return g.prototype=Object.create(Object.getPrototypeOf(a)),p(new g,A)}}},{}],7:[function(c,m){"use strict";function p(w){console&&console.warn&&console.warn(w)}function a(){a.init.call(this)}function _(w){if(typeof w!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof w)}function A(w){return w._maxListeners===void 0?a.defaultMaxListeners:w._maxListeners}function i(w,E,I,M){var j,V,H;if(_(I),V=w._events,V===void 0?(V=w._events=Object.create(null),w._eventsCount=0):(V.newListener!==void 0&&(w.emit("newListener",E,I.listener?I.listener:I),V=w._events),H=V[E]),H===void 0)H=V[E]=I,++w._eventsCount;else if(typeof H=="function"?H=V[E]=M?[I,H]:[H,I]:M?H.unshift(I):H.push(I),j=A(w),0<j&&H.length>j&&!H.warned){H.warned=!0;var Z=new Error("Possible EventEmitter memory leak detected. "+H.length+" "+(E+" listeners added. Use emitter.setMaxListeners() to increase limit"));Z.name="MaxListenersExceededWarning",Z.emitter=w,Z.type=E,Z.count=H.length,p(Z)}return w}function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(w,E,I){var M={fired:!1,wrapFn:void 0,target:w,type:E,listener:I},j=g.bind(M);return j.listener=I,M.wrapFn=j,j}function u(w,E,I){var M=w._events;if(M===void 0)return[];var j=M[E];return j===void 0?[]:typeof j=="function"?I?[j.listener||j]:[j]:I?O(j):C(j,j.length)}function x(w){var E=this._events;if(E!==void 0){var I=E[w];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}function C(w,E){for(var I=Array(E),M=0;M<E;++M)I[M]=w[M];return I}function k(w,E){for(;E+1<w.length;E++)w[E]=w[E+1];w.pop()}function O(w){for(var E=Array(w.length),I=0;I<E.length;++I)E[I]=w[I].listener||w[I];return E}function l(w,E,I){typeof w.on=="function"&&f(w,"error",E,I)}function f(w,E,I,M){if(typeof w.on=="function")M.once?w.once(E,I):w.on(E,I);else if(typeof w.addEventListener=="function")w.addEventListener(E,function j(V){M.once&&w.removeEventListener(E,j),I(V)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof w)}var d,v=typeof Reflect=="object"?Reflect:null,b=v&&typeof v.apply=="function"?v.apply:function(w,E,I){return Function.prototype.apply.call(w,E,I)};d=v&&typeof v.ownKeys=="function"?v.ownKeys:Object.getOwnPropertySymbols?function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:function(w){return Object.getOwnPropertyNames(w)};var T=Number.isNaN||function(w){return w!==w};m.exports=a,m.exports.once=function(w,E){return new Promise(function(I,M){function j(H){w.removeListener(E,V),M(H)}function V(){typeof w.removeListener=="function"&&w.removeListener("error",j),I([].slice.call(arguments))}f(w,E,V,{once:!0}),E!=="error"&&l(w,j,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var N=10;Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return N},set:function(w){if(typeof w!="number"||0>w||T(w))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+w+".");N=w}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(w){if(typeof w!="number"||0>w||T(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this},a.prototype.getMaxListeners=function(){return A(this)},a.prototype.emit=function(w){for(var E=[],I=1;I<arguments.length;I++)E.push(arguments[I]);var M=w==="error",j=this._events;if(j!==void 0)M=M&&j.error===void 0;else if(!M)return!1;if(M){var V;if(0<E.length&&(V=E[0]),V instanceof Error)throw V;var H=new Error("Unhandled error."+(V?" ("+V.message+")":""));throw H.context=V,H}var Z=j[w];if(Z===void 0)return!1;if(typeof Z=="function")b(Z,this,E);else for(var rt=Z.length,F=C(Z,rt),I=0;I<rt;++I)b(F[I],this,E);return!0},a.prototype.addListener=function(w,E){return i(this,w,E,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(w,E){return i(this,w,E,!0)},a.prototype.once=function(w,E){return _(E),this.on(w,y(this,w,E)),this},a.prototype.prependOnceListener=function(w,E){return _(E),this.prependListener(w,y(this,w,E)),this},a.prototype.removeListener=function(w,E){var I,M,j,V,H;if(_(E),M=this._events,M===void 0)return this;if(I=M[w],I===void 0)return this;if(I===E||I.listener===E)--this._eventsCount==0?this._events=Object.create(null):(delete M[w],M.removeListener&&this.emit("removeListener",w,I.listener||E));else if(typeof I!="function"){for(j=-1,V=I.length-1;0<=V;V--)if(I[V]===E||I[V].listener===E){H=I[V].listener,j=V;break}if(0>j)return this;j===0?I.shift():k(I,j),I.length===1&&(M[w]=I[0]),M.removeListener!==void 0&&this.emit("removeListener",w,H||E)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(w){var E,I,M;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[w]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete I[w]),this;if(arguments.length===0){var j,V=Object.keys(I);for(M=0;M<V.length;++M)j=V[M],j!=="removeListener"&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=I[w],typeof E=="function")this.removeListener(w,E);else if(E!==void 0)for(M=E.length-1;0<=M;M--)this.removeListener(w,E[M]);return this},a.prototype.listeners=function(w){return u(this,w,!0)},a.prototype.rawListeners=function(w){return u(this,w,!1)},a.listenerCount=function(w,E){return typeof w.listenerCount=="function"?w.listenerCount(E):x.call(w,E)},a.prototype.listenerCount=x,a.prototype.eventNames=function(){return 0<this._eventsCount?d(this._events):[]}},{}],8:[function(c,m){m.exports=function(){if(typeof globalThis>"u")return null;var p={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return p.RTCPeerConnection?p:null}},{}],9:[function(c,m,p){p.read=function(a,_,A,i,g){var y,u,x=8*g-i-1,C=(1<<x)-1,k=C>>1,O=-7,l=A?g-1:0,f=A?-1:1,d=a[_+l];for(l+=f,y=d&(1<<-O)-1,d>>=-O,O+=x;0<O;y=256*y+a[_+l],l+=f,O-=8);for(u=y&(1<<-O)-1,y>>=-O,O+=i;0<O;u=256*u+a[_+l],l+=f,O-=8);if(y===0)y=1-k;else{if(y===C)return u?NaN:(d?-1:1)*(1/0);u+=s(2,i),y-=k}return(d?-1:1)*u*s(2,y-i)},p.write=function(a,_,A,i,g,y){var u,x,C,k=Math.LN2,O=Math.log,l=8*y-g-1,f=(1<<l)-1,d=f>>1,v=g===23?s(2,-24)-s(2,-77):0,b=i?0:y-1,T=i?1:-1,N=0>_||_===0&&0>1/_?1:0;for(_=o(_),isNaN(_)||_===1/0?(x=isNaN(_)?1:0,u=f):(u=r(O(_)/k),1>_*(C=s(2,-u))&&(u--,C*=2),_+=1<=u+d?v/C:v*s(2,1-d),2<=_*C&&(u++,C/=2),u+d>=f?(x=0,u=f):1<=u+d?(x=(_*C-1)*s(2,g),u+=d):(x=_*s(2,d-1)*s(2,g),u=0));8<=g;a[A+b]=255&x,b+=T,x/=256,g-=8);for(u=u<<g|x,l+=g;0<l;a[A+b]=255&u,b+=T,u/=256,l-=8);a[A+b-T]|=128*N}},{}],10:[function(c,m){m.exports=typeof Object.create=="function"?function(p,a){a&&(p.super_=a,p.prototype=Object.create(a.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}))}:function(p,a){if(a){p.super_=a;var _=function(){};_.prototype=a.prototype,p.prototype=new _,p.prototype.constructor=p}}},{}],11:[function(c,m){var p=Math.round;function a(y){if(y+="",!(100<y.length)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(u){var x=parseFloat(u[1]),C=(u[2]||"ms").toLowerCase();return C==="years"||C==="year"||C==="yrs"||C==="yr"||C==="y"?315576e5*x:C==="weeks"||C==="week"||C==="w"?6048e5*x:C==="days"||C==="day"||C==="d"?864e5*x:C==="hours"||C==="hour"||C==="hrs"||C==="hr"||C==="h"?36e5*x:C==="minutes"||C==="minute"||C==="mins"||C==="min"||C==="m"?6e4*x:C==="seconds"||C==="second"||C==="secs"||C==="sec"||C==="s"?1e3*x:C==="milliseconds"||C==="millisecond"||C==="msecs"||C==="msec"||C==="ms"?x:void 0}}}function _(y){var u=o(y);return 864e5<=u?p(y/864e5)+"d":36e5<=u?p(y/36e5)+"h":6e4<=u?p(y/6e4)+"m":1e3<=u?p(y/1e3)+"s":y+"ms"}function A(y){var u=o(y);return 864e5<=u?i(y,u,864e5,"day"):36e5<=u?i(y,u,36e5,"hour"):6e4<=u?i(y,u,6e4,"minute"):1e3<=u?i(y,u,1e3,"second"):y+" ms"}function i(y,u,x,C){return p(y/x)+" "+C+(u>=1.5*x?"s":"")}var g=24*(60*6e4);m.exports=function(y,u){u=u||{};var x=typeof y;if(x=="string"&&0<y.length)return a(y);if(x==="number"&&isFinite(y))return u.long?A(y):_(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))}},{}],12:[function(c,m){function p(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function _(v){if(x===setTimeout)return setTimeout(v,0);if((x===p||!x)&&setTimeout)return x=setTimeout,setTimeout(v,0);try{return x(v,0)}catch{try{return x.call(null,v,0)}catch{return x.call(this,v,0)}}}function A(v){if(C===clearTimeout)return clearTimeout(v);if((C===a||!C)&&clearTimeout)return C=clearTimeout,clearTimeout(v);try{return C(v)}catch{try{return C.call(null,v)}catch{return C.call(this,v)}}}function i(){f&&O&&(f=!1,O.length?l=O.concat(l):d=-1,l.length&&g())}function g(){if(!f){var v=_(i);f=!0;for(var b=l.length;b;){for(O=l,l=[];++d<b;)O&&O[d].run();d=-1,b=l.length}O=null,f=!1,A(v)}}function y(v,b){this.fun=v,this.array=b}function u(){}var x,C,k=m.exports={};(function(){try{x=typeof setTimeout=="function"?setTimeout:p}catch{x=p}try{C=typeof clearTimeout=="function"?clearTimeout:a}catch{C=a}})();var O,l=[],f=!1,d=-1;k.nextTick=function(v){var b=Array(arguments.length-1);if(1<arguments.length)for(var T=1;T<arguments.length;T++)b[T-1]=arguments[T];l.push(new y(v,b)),l.length!==1||f||_(g)},y.prototype.run=function(){this.fun.apply(null,this.array)},k.title="browser",k.browser=!0,k.env={},k.argv=[],k.version="",k.versions={},k.on=u,k.addListener=u,k.once=u,k.off=u,k.removeListener=u,k.removeAllListeners=u,k.emit=u,k.prependListener=u,k.prependOnceListener=u,k.listeners=function(){return[]},k.binding=function(){throw new Error("process.binding is not supported")},k.cwd=function(){return"/"},k.chdir=function(){throw new Error("process.chdir is not supported")},k.umask=function(){return 0}},{}],13:[function(c,m){(function(p){(function(){let a;m.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?p:window):_=>(a||(a=Promise.resolve())).then(_).catch(A=>setTimeout(()=>{throw A},0))}).call(this)}).call(this,typeof globalThis>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:globalThis)},{}],14:[function(c,m){(function(p,a){(function(){"use strict";var _=c("safe-buffer").Buffer,A=a.crypto||a.msCrypto;m.exports=A&&A.getRandomValues?function(i,g){if(i>4294967295)throw new RangeError("requested too many random bytes");var y=_.allocUnsafe(i);if(0<i)if(65536<i)for(var u=0;u<i;u+=65536)A.getRandomValues(y.slice(u,u+65536));else A.getRandomValues(y);return typeof g=="function"?p.nextTick(function(){g(null,y)}):y}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,c("_process"),typeof globalThis>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:globalThis)},{_process:12,"safe-buffer":30}],15:[function(c,m){"use strict";function p(u,x){u.prototype=Object.create(x.prototype),u.prototype.constructor=u,u.__proto__=x}function a(u,x,C){function k(l,f,d){return typeof x=="string"?x:x(l,f,d)}C||(C=Error);var O=function(l){function f(d,v,b){return l.call(this,k(d,v,b))||this}return p(f,l),f}(C);O.prototype.name=C.name,O.prototype.code=u,y[u]=O}function _(u,x){if(Array.isArray(u)){var C=u.length;return u=u.map(function(k){return k+""}),2<C?"one of ".concat(x," ").concat(u.slice(0,C-1).join(", "),", or ")+u[C-1]:C===2?"one of ".concat(x," ").concat(u[0]," or ").concat(u[1]):"of ".concat(x," ").concat(u[0])}return"of ".concat(x," ").concat(u+"")}function A(u,x,C){return u.substr(!C||0>C?0:+C,x.length)===x}function i(u,x,C){return(C===void 0||C>u.length)&&(C=u.length),u.substring(C-x.length,C)===x}function g(u,x,C){return typeof C!="number"&&(C=0),!(C+x.length>u.length)&&u.indexOf(x,C)!==-1}var y={};a("ERR_INVALID_OPT_VALUE",function(u,x){return'The value "'+x+'" is invalid for option "'+u+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(u,x,C){var k;typeof x=="string"&&A(x,"not ")?(k="must not be",x=x.replace(/^not /,"")):k="must be";var O;if(i(u," argument"))O="The ".concat(u," ").concat(k," ").concat(_(x,"type"));else{var l=g(u,".")?"property":"argument";O='The "'.concat(u,'" ').concat(l," ").concat(k," ").concat(_(x,"type"))}return O+=". Received type ".concat(typeof C),O},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),m.exports.codes=y},{}],16:[function(c,m){(function(p){(function(){"use strict";function a(k){return this instanceof a?(g.call(this,k),y.call(this,k),this.allowHalfOpen=!0,void(k&&(k.readable===!1&&(this.readable=!1),k.writable===!1&&(this.writable=!1),k.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",_))))):new a(k)}function _(){this._writableState.ended||p.nextTick(A,this)}function A(k){k.end()}var i=Object.keys||function(k){var O=[];for(var l in k)O.push(l);return O};m.exports=a;var g=c("./_stream_readable"),y=c("./_stream_writable");c("inherits")(a,g);for(var u,x=i(y.prototype),C=0;C<x.length;C++)u=x[C],a.prototype[u]||(a.prototype[u]=y.prototype[u]);Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(k){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=k,this._writableState.destroyed=k)}})}).call(this)}).call(this,c("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(c,m){"use strict";function p(_){return this instanceof p?void a.call(this,_):new p(_)}m.exports=p;var a=c("./_stream_transform");c("inherits")(p,a),p.prototype._transform=function(_,A,i){i(null,_)}},{"./_stream_transform":19,inherits:10}],18:[function(c,m){(function(p,a){(function(){"use strict";function _(t){return K.from(t)}function A(t){return K.isBuffer(t)||t instanceof J}function i(t,e,n){return typeof t.prependListener=="function"?t.prependListener(e,n):void(t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n))}function g(t,e,n){rt=rt||c("./_stream_duplex"),t=t||{},typeof n!="boolean"&&(n=e instanceof rt),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=Jt(this,t,"readableHighWaterMark",n),this.buffer=new $t,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(!ut&&(ut=c("string_decoder/").StringDecoder),this.decoder=new ut(t.encoding),this.encoding=t.encoding)}function y(t){if(rt=rt||c("./_stream_duplex"),!(this instanceof y))return new y(t);var e=this instanceof rt;this._readableState=new g(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),yt.call(this)}function u(t,e,n,h,R){F("readableAddChunk",e);var U=t._readableState;if(e===null)U.reading=!1,l(t,U);else{var D;if(R||(D=C(U,e)),D)P(t,D);else if(!(U.objectMode||e&&0<e.length))h||(U.reading=!1,v(t,U));else if(typeof e=="string"||U.objectMode||Object.getPrototypeOf(e)===K.prototype||(e=_(e)),h)U.endEmitted?P(t,new B):x(t,U,e,!0);else if(U.ended)P(t,new S);else{if(U.destroyed)return!1;U.reading=!1,U.decoder&&!n?(e=U.decoder.write(e),U.objectMode||e.length!==0?x(t,U,e,!1):v(t,U)):x(t,U,e,!1)}}return!U.ended&&(U.length<U.highWaterMark||U.length===0)}function x(t,e,n,h){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,h?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&f(t)),v(t,e)}function C(t,e){var n;return A(e)||typeof e=="string"||e===void 0||t.objectMode||(n=new ht("chunk",["string","Buffer","Uint8Array"],e)),n}function k(t){return 1073741824<=t?t=1073741824:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function O(t,e){return 0>=t||e.length===0&&e.ended?0:e.objectMode?1:t===t?(t>e.highWaterMark&&(e.highWaterMark=k(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0)):e.flowing&&e.length?e.buffer.head.data.length:e.length}function l(t,e){if(F("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?f(t):(e.needReadable=!1,!e.emittedReadable&&(e.emittedReadable=!0,d(t)))}}function f(t){var e=t._readableState;F("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(F("emitReadable",e.flowing),e.emittedReadable=!0,p.nextTick(d,t))}function d(t){var e=t._readableState;F("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,M(t)}function v(t,e){e.readingMore||(e.readingMore=!0,p.nextTick(b,t,e))}function b(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var n=e.length;if(F("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function T(t){return function(){var e=t._readableState;F("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&Et(t,"data")&&(e.flowing=!0,M(t))}}function N(t){var e=t._readableState;e.readableListening=0<t.listenerCount("readable"),e.resumeScheduled&&!e.paused?e.flowing=!0:0<t.listenerCount("data")&&t.resume()}function w(t){F("readable nexttick read 0"),t.read(0)}function E(t,e){e.resumeScheduled||(e.resumeScheduled=!0,p.nextTick(I,t,e))}function I(t,e){F("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),M(t),e.flowing&&!e.reading&&t.read(0)}function M(t){var e=t._readableState;for(F("flow",e.flowing);e.flowing&&t.read()!==null;);}function j(t,e){if(e.length===0)return null;var n;return e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):e.buffer.length===1?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n}function V(t){var e=t._readableState;F("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,p.nextTick(H,e,t))}function H(t,e){if(F("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function Z(t,e){for(var n=0,h=t.length;n<h;n++)if(t[n]===e)return n;return-1}m.exports=y;var rt;y.ReadableState=g;var F,ce=c("events").EventEmitter,Et=function(t,e){return t.listeners(e).length},yt=c("./internal/streams/stream"),K=c("buffer").Buffer,J=a.Uint8Array||function(){},xt=c("util");F=xt&&xt.debuglog?xt.debuglog("stream"):function(){};var ut,St,Rt,$t=c("./internal/streams/buffer_list"),bt=c("./internal/streams/destroy"),Kt=c("./internal/streams/state"),Jt=Kt.getHighWaterMark,nt=c("../errors").codes,ht=nt.ERR_INVALID_ARG_TYPE,S=nt.ERR_STREAM_PUSH_AFTER_EOF,L=nt.ERR_METHOD_NOT_IMPLEMENTED,B=nt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;c("inherits")(y,yt);var P=bt.errorOrDestroy,q=["error","close","destroy","pause","resume"];Object.defineProperty(y.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),y.prototype.destroy=bt.destroy,y.prototype._undestroy=bt.undestroy,y.prototype._destroy=function(t,e){e(t)},y.prototype.push=function(t,e){var n,h=this._readableState;return h.objectMode?n=!0:typeof t=="string"&&(e=e||h.defaultEncoding,e!==h.encoding&&(t=K.from(t,e),e=""),n=!0),u(this,t,e,!1,n)},y.prototype.unshift=function(t){return u(this,t,null,!0,!1)},y.prototype.isPaused=function(){return this._readableState.flowing===!1},y.prototype.setEncoding=function(t){ut||(ut=c("string_decoder/").StringDecoder);var e=new ut(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,h="";n!==null;)h+=e.write(n.data),n=n.next;return this._readableState.buffer.clear(),h!==""&&this._readableState.buffer.push(h),this._readableState.length=h.length,this},y.prototype.read=function(t){F("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark===0?0<e.length:e.length>=e.highWaterMark)||e.ended))return F("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?V(this):f(this),null;if(t=O(t,e),t===0&&e.ended)return e.length===0&&V(this),null;var h=e.needReadable;F("need readable",h),(e.length===0||e.length-t<e.highWaterMark)&&(h=!0,F("length less than watermark",h)),e.ended||e.reading?(h=!1,F("reading or ended",h)):h&&(F("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,!e.reading&&(t=O(n,e)));var R;return R=0<t?j(t,e):null,R===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(!e.ended&&(e.needReadable=!0),n!==t&&e.ended&&V(this)),R!==null&&this.emit("data",R),R},y.prototype._read=function(){P(this,new L("_read()"))},y.prototype.pipe=function(t,e){function n(Dt,Mt){F("onunpipe"),Dt===Y&&Mt&&Mt.hasUnpiped===!1&&(Mt.hasUnpiped=!0,R())}function h(){F("onend"),t.end()}function R(){F("cleanup"),t.removeListener("close",W),t.removeListener("finish",X),t.removeListener("drain",Bt),t.removeListener("error",D),t.removeListener("unpipe",n),Y.removeListener("end",h),Y.removeListener("end",z),Y.removeListener("data",U),yr=!0,G.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&Bt()}function U(Dt){F("ondata");var Mt=t.write(Dt);F("dest.write",Mt),Mt===!1&&((G.pipesCount===1&&G.pipes===t||1<G.pipesCount&&Z(G.pipes,t)!==-1)&&!yr&&(F("false write response, pause",G.awaitDrain),G.awaitDrain++),Y.pause())}function D(Dt){F("onerror",Dt),z(),t.removeListener("error",D),Et(t,"error")===0&&P(t,Dt)}function W(){t.removeListener("finish",X),z()}function X(){F("onfinish"),t.removeListener("close",W),z()}function z(){F("unpipe"),Y.unpipe(t)}var Y=this,G=this._readableState;switch(G.pipesCount){case 0:G.pipes=t;break;case 1:G.pipes=[G.pipes,t];break;default:G.pipes.push(t)}G.pipesCount+=1,F("pipe count=%d opts=%j",G.pipesCount,e);var It=(!e||e.end!==!1)&&t!==p.stdout&&t!==p.stderr,Xt=It?h:z;G.endEmitted?p.nextTick(Xt):Y.once("end",Xt),t.on("unpipe",n);var Bt=T(Y);t.on("drain",Bt);var yr=!1;return Y.on("data",U),i(t,"error",D),t.once("close",W),t.once("finish",X),t.emit("pipe",Y),G.flowing||(F("pipe resume"),Y.resume()),t},y.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var h=e.pipes,R=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var U=0;U<R;U++)h[U].emit("unpipe",this,{hasUnpiped:!1});return this}var D=Z(e.pipes,t);return D===-1?this:(e.pipes.splice(D,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},y.prototype.on=function(t,e){var n=yt.prototype.on.call(this,t,e),h=this._readableState;return t==="data"?(h.readableListening=0<this.listenerCount("readable"),h.flowing!==!1&&this.resume()):t=="readable"&&!h.endEmitted&&!h.readableListening&&(h.readableListening=h.needReadable=!0,h.flowing=!1,h.emittedReadable=!1,F("on readable",h.length,h.reading),h.length?f(this):!h.reading&&p.nextTick(w,this)),n},y.prototype.addListener=y.prototype.on,y.prototype.removeListener=function(t,e){var n=yt.prototype.removeListener.call(this,t,e);return t==="readable"&&p.nextTick(N,this),n},y.prototype.removeAllListeners=function(t){var e=yt.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&p.nextTick(N,this),e},y.prototype.resume=function(){var t=this._readableState;return t.flowing||(F("resume"),t.flowing=!t.readableListening,E(this,t)),t.paused=!1,this},y.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},y.prototype.wrap=function(t){var e=this,n=this._readableState,h=!1;for(var R in t.on("end",function(){if(F("wrapped end"),n.decoder&&!n.ended){var D=n.decoder.end();D&&D.length&&e.push(D)}e.push(null)}),t.on("data",function(D){if(F("wrapped data"),n.decoder&&(D=n.decoder.write(D)),!(n.objectMode&&D==null)&&(n.objectMode||D&&D.length)){var W=e.push(D);W||(h=!0,t.pause())}}),t)this[R]===void 0&&typeof t[R]=="function"&&(this[R]=function(D){return function(){return t[D].apply(t,arguments)}}(R));for(var U=0;U<q.length;U++)t.on(q[U],this.emit.bind(this,q[U]));return this._read=function(D){F("wrapped _read",D),h&&(h=!1,t.resume())},this},typeof Symbol=="function"&&(y.prototype[Symbol.asyncIterator]=function(){return St===void 0&&(St=c("./internal/streams/async_iterator")),St(this)}),Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(y.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(y.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),y._fromList=j,Object.defineProperty(y.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(y.from=function(t,e){return Rt===void 0&&(Rt=c("./internal/streams/from")),Rt(y,t,e)})}).call(this)}).call(this,c("_process"),typeof globalThis>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:globalThis)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(c,m){"use strict";function p(k,O){var l=this._transformState;l.transforming=!1;var f=l.writecb;if(f===null)return this.emit("error",new y);l.writechunk=null,l.writecb=null,O!=null&&this.push(O),f(k);var d=this._readableState;d.reading=!1,(d.needReadable||d.length<d.highWaterMark)&&this._read(d.highWaterMark)}function a(k){return this instanceof a?(C.call(this,k),this._transformState={afterTransform:p.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,k&&(typeof k.transform=="function"&&(this._transform=k.transform),typeof k.flush=="function"&&(this._flush=k.flush)),void this.on("prefinish",_)):new a(k)}function _(){var k=this;typeof this._flush!="function"||this._readableState.destroyed?A(this,null,null):this._flush(function(O,l){A(k,O,l)})}function A(k,O,l){if(O)return k.emit("error",O);if(l!=null&&k.push(l),k._writableState.length)throw new x;if(k._transformState.transforming)throw new u;return k.push(null)}m.exports=a;var i=c("../errors").codes,g=i.ERR_METHOD_NOT_IMPLEMENTED,y=i.ERR_MULTIPLE_CALLBACK,u=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,x=i.ERR_TRANSFORM_WITH_LENGTH_0,C=c("./_stream_duplex");c("inherits")(a,C),a.prototype.push=function(k,O){return this._transformState.needTransform=!1,C.prototype.push.call(this,k,O)},a.prototype._transform=function(k,O,l){l(new g("_transform()"))},a.prototype._write=function(k,O,l){var f=this._transformState;if(f.writecb=l,f.writechunk=k,f.writeencoding=O,!f.transforming){var d=this._readableState;(f.needTransform||d.needReadable||d.length<d.highWaterMark)&&this._read(d.highWaterMark)}},a.prototype._read=function(){var k=this._transformState;k.writechunk===null||k.transforming?k.needTransform=!0:(k.transforming=!0,this._transform(k.writechunk,k.writeencoding,k.afterTransform))},a.prototype._destroy=function(k,O){C.prototype._destroy.call(this,k,function(l){O(l)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(c,m){(function(p,a){(function(){"use strict";function _(S){var L=this;this.next=null,this.entry=null,this.finish=function(){V(L,S)}}function A(S){return F.from(S)}function i(S){return F.isBuffer(S)||S instanceof ce}function g(){}function y(S,L,B){H=H||c("./_stream_duplex"),S=S||{},typeof B!="boolean"&&(B=L instanceof H),this.objectMode=!!S.objectMode,B&&(this.objectMode=this.objectMode||!!S.writableObjectMode),this.highWaterMark=K(this,S,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var P=S.decodeStrings===!1;this.decodeStrings=!P,this.defaultEncoding=S.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(q){v(L,q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=S.emitClose!==!1,this.autoDestroy=!!S.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}function u(S){H=H||c("./_stream_duplex");var L=this instanceof H;return L||ht.call(u,this)?(this._writableState=new y(S,this,L),this.writable=!0,S&&(typeof S.write=="function"&&(this._write=S.write),typeof S.writev=="function"&&(this._writev=S.writev),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.final=="function"&&(this._final=S.final)),void rt.call(this)):new u(S)}function x(S,L){var B=new Kt;nt(S,B),p.nextTick(L,B)}function C(S,L,B,P){var q;return B===null?q=new bt:typeof B!="string"&&!L.objectMode&&(q=new xt("chunk",["string","Buffer"],B)),!q||(nt(S,q),p.nextTick(P,q),!1)}function k(S,L,B){return S.objectMode||S.decodeStrings===!1||typeof L!="string"||(L=F.from(L,B)),L}function O(S,L,B,P,q,t){if(!B){var e=k(L,P,q);P!==e&&(B=!0,q="buffer",P=e)}var n=L.objectMode?1:P.length;L.length+=n;var h=L.length<L.highWaterMark;if(h||(L.needDrain=!0),L.writing||L.corked){var R=L.lastBufferedRequest;L.lastBufferedRequest={chunk:P,encoding:q,isBuf:B,callback:t,next:null},R?R.next=L.lastBufferedRequest:L.bufferedRequest=L.lastBufferedRequest,L.bufferedRequestCount+=1}else l(S,L,!1,n,P,q,t);return h}function l(S,L,B,P,q,t,e){L.writelen=P,L.writecb=e,L.writing=!0,L.sync=!0,L.destroyed?L.onwrite(new $t("write")):B?S._writev(q,L.onwrite):S._write(q,t,L.onwrite),L.sync=!1}function f(S,L,B,P,q){--L.pendingcb,B?(p.nextTick(q,P),p.nextTick(M,S,L),S._writableState.errorEmitted=!0,nt(S,P)):(q(P),S._writableState.errorEmitted=!0,nt(S,P),M(S,L))}function d(S){S.writing=!1,S.writecb=null,S.length-=S.writelen,S.writelen=0}function v(S,L){var B=S._writableState,P=B.sync,q=B.writecb;if(typeof q!="function")throw new St;if(d(B),L)f(S,B,P,L,q);else{var t=w(B)||S.destroyed;t||B.corked||B.bufferProcessing||!B.bufferedRequest||N(S,B),P?p.nextTick(b,S,B,t,q):b(S,B,t,q)}}function b(S,L,B,P){B||T(S,L),L.pendingcb--,P(),M(S,L)}function T(S,L){L.length===0&&L.needDrain&&(L.needDrain=!1,S.emit("drain"))}function N(S,L){L.bufferProcessing=!0;var B=L.bufferedRequest;if(S._writev&&B&&B.next){var P=L.bufferedRequestCount,q=Array(P),t=L.corkedRequestsFree;t.entry=B;for(var e=0,n=!0;B;)q[e]=B,B.isBuf||(n=!1),B=B.next,e+=1;q.allBuffers=n,l(S,L,!0,L.length,q,"",t.finish),L.pendingcb++,L.lastBufferedRequest=null,t.next?(L.corkedRequestsFree=t.next,t.next=null):L.corkedRequestsFree=new _(L),L.bufferedRequestCount=0}else{for(;B;){var h=B.chunk,R=B.encoding,U=B.callback,D=L.objectMode?1:h.length;if(l(S,L,!1,D,h,R,U),B=B.next,L.bufferedRequestCount--,L.writing)break}B===null&&(L.lastBufferedRequest=null)}L.bufferedRequest=B,L.bufferProcessing=!1}function w(S){return S.ending&&S.length===0&&S.bufferedRequest===null&&!S.finished&&!S.writing}function E(S,L){S._final(function(B){L.pendingcb--,B&&nt(S,B),L.prefinished=!0,S.emit("prefinish"),M(S,L)})}function I(S,L){L.prefinished||L.finalCalled||(typeof S._final!="function"||L.destroyed?(L.prefinished=!0,S.emit("prefinish")):(L.pendingcb++,L.finalCalled=!0,p.nextTick(E,S,L)))}function M(S,L){var B=w(L);if(B&&(I(S,L),L.pendingcb===0&&(L.finished=!0,S.emit("finish"),L.autoDestroy))){var P=S._readableState;(!P||P.autoDestroy&&P.endEmitted)&&S.destroy()}return B}function j(S,L,B){L.ending=!0,M(S,L),B&&(L.finished?p.nextTick(B):S.once("finish",B)),L.ended=!0,S.writable=!1}function V(S,L,B){var P=S.entry;for(S.entry=null;P;){var q=P.callback;L.pendingcb--,q(B),P=P.next}L.corkedRequestsFree.next=S}m.exports=u;var H;u.WritableState=y;var Z={deprecate:c("util-deprecate")},rt=c("./internal/streams/stream"),F=c("buffer").Buffer,ce=a.Uint8Array||function(){},Et=c("./internal/streams/destroy"),yt=c("./internal/streams/state"),K=yt.getHighWaterMark,J=c("../errors").codes,xt=J.ERR_INVALID_ARG_TYPE,ut=J.ERR_METHOD_NOT_IMPLEMENTED,St=J.ERR_MULTIPLE_CALLBACK,Rt=J.ERR_STREAM_CANNOT_PIPE,$t=J.ERR_STREAM_DESTROYED,bt=J.ERR_STREAM_NULL_VALUES,Kt=J.ERR_STREAM_WRITE_AFTER_END,Jt=J.ERR_UNKNOWN_ENCODING,nt=Et.errorOrDestroy;c("inherits")(u,rt),y.prototype.getBuffer=function(){for(var S=this.bufferedRequest,L=[];S;)L.push(S),S=S.next;return L},function(){try{Object.defineProperty(y.prototype,"buffer",{get:Z.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var ht;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ht=Function.prototype[Symbol.hasInstance],Object.defineProperty(u,Symbol.hasInstance,{value:function(S){return!!ht.call(this,S)||this===u&&S&&S._writableState instanceof y}})):ht=function(S){return S instanceof this},u.prototype.pipe=function(){nt(this,new Rt)},u.prototype.write=function(S,L,B){var P=this._writableState,q=!1,t=!P.objectMode&&i(S);return t&&!F.isBuffer(S)&&(S=A(S)),typeof L=="function"&&(B=L,L=null),t?L="buffer":!L&&(L=P.defaultEncoding),typeof B!="function"&&(B=g),P.ending?x(this,B):(t||C(this,P,S,B))&&(P.pendingcb++,q=O(this,P,t,S,L,B)),q},u.prototype.cork=function(){this._writableState.corked++},u.prototype.uncork=function(){var S=this._writableState;S.corked&&(S.corked--,!S.writing&&!S.corked&&!S.bufferProcessing&&S.bufferedRequest&&N(this,S))},u.prototype.setDefaultEncoding=function(S){if(typeof S=="string"&&(S=S.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((S+"").toLowerCase())))throw new Jt(S);return this._writableState.defaultEncoding=S,this},Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),u.prototype._write=function(S,L,B){B(new ut("_write()"))},u.prototype._writev=null,u.prototype.end=function(S,L,B){var P=this._writableState;return typeof S=="function"?(B=S,S=null,L=null):typeof L=="function"&&(B=L,L=null),S!=null&&this.write(S,L),P.corked&&(P.corked=1,this.uncork()),P.ending||j(this,P,B),this},Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(S){this._writableState&&(this._writableState.destroyed=S)}}),u.prototype.destroy=Et.destroy,u.prototype._undestroy=Et.undestroy,u.prototype._destroy=function(S,L){L(S)}}).call(this)}).call(this,c("_process"),typeof globalThis>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:globalThis)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(c,m){(function(p){(function(){"use strict";function a(T,N,w){return N in T?Object.defineProperty(T,N,{value:w,enumerable:!0,configurable:!0,writable:!0}):T[N]=w,T}function _(T,N){return{value:T,done:N}}function A(T){var N=T[x];if(N!==null){var w=T[d].read();w!==null&&(T[l]=null,T[x]=null,T[C]=null,N(_(w,!1)))}}function i(T){p.nextTick(A,T)}function g(T,N){return function(w,E){T.then(function(){return N[O]?void w(_(void 0,!0)):void N[f](w,E)},E)}}var y,u=c("./end-of-stream"),x=Symbol("lastResolve"),C=Symbol("lastReject"),k=Symbol("error"),O=Symbol("ended"),l=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream"),v=Object.getPrototypeOf(function(){}),b=Object.setPrototypeOf((y={get stream(){return this[d]},next:function(){var T=this,N=this[k];if(N!==null)return Promise.reject(N);if(this[O])return Promise.resolve(_(void 0,!0));if(this[d].destroyed)return new Promise(function(M,j){p.nextTick(function(){T[k]?j(T[k]):M(_(void 0,!0))})});var w,E=this[l];if(E)w=new Promise(g(E,this));else{var I=this[d].read();if(I!==null)return Promise.resolve(_(I,!1));w=new Promise(this[f])}return this[l]=w,w}},a(y,Symbol.asyncIterator,function(){return this}),a(y,"return",function(){var T=this;return new Promise(function(N,w){T[d].destroy(null,function(E){return E?void w(E):void N(_(void 0,!0))})})}),y),v);m.exports=function(T){var N,w=Object.create(b,(N={},a(N,d,{value:T,writable:!0}),a(N,x,{value:null,writable:!0}),a(N,C,{value:null,writable:!0}),a(N,k,{value:null,writable:!0}),a(N,O,{value:T._readableState.endEmitted,writable:!0}),a(N,f,{value:function(E,I){var M=w[d].read();M?(w[l]=null,w[x]=null,w[C]=null,E(_(M,!1))):(w[x]=E,w[C]=I)},writable:!0}),N));return w[l]=null,u(T,function(E){if(E&&E.code!=="ERR_STREAM_PREMATURE_CLOSE"){var I=w[C];return I!==null&&(w[l]=null,w[x]=null,w[C]=null,I(E)),void(w[k]=E)}var M=w[x];M!==null&&(w[l]=null,w[x]=null,w[C]=null,M(_(void 0,!0))),w[O]=!0}),T.on("readable",i.bind(null,w)),w}}).call(this)}).call(this,c("_process"))},{"./end-of-stream":24,_process:12}],22:[function(c,m){"use strict";function p(l,f){var d=Object.keys(l);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(l);f&&(v=v.filter(function(b){return Object.getOwnPropertyDescriptor(l,b).enumerable})),d.push.apply(d,v)}return d}function a(l){for(var f,d=1;d<arguments.length;d++)f=arguments[d]==null?{}:arguments[d],d%2?p(Object(f),!0).forEach(function(v){_(l,v,f[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(f)):p(Object(f)).forEach(function(v){Object.defineProperty(l,v,Object.getOwnPropertyDescriptor(f,v))});return l}function _(l,f,d){return f in l?Object.defineProperty(l,f,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[f]=d,l}function A(l,f){if(!(l instanceof f))throw new TypeError("Cannot call a class as a function")}function i(l,f){for(var d,v=0;v<f.length;v++)d=f[v],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(l,d.key,d)}function g(l,f,d){return f&&i(l.prototype,f),d&&i(l,d),l}function y(l,f,d){x.prototype.copy.call(l,f,d)}var u=c("buffer"),x=u.Buffer,C=c("util"),k=C.inspect,O=k&&k.custom||"inspect";m.exports=function(){function l(){A(this,l),this.head=null,this.tail=null,this.length=0}return g(l,[{key:"push",value:function(f){var d={data:f,next:null};0<this.length?this.tail.next=d:this.head=d,this.tail=d,++this.length}},{key:"unshift",value:function(f){var d={data:f,next:this.head};this.length===0&&(this.tail=d),this.head=d,++this.length}},{key:"shift",value:function(){if(this.length!==0){var f=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,f}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(f){if(this.length===0)return"";for(var d=this.head,v=""+d.data;d=d.next;)v+=f+d.data;return v}},{key:"concat",value:function(f){if(this.length===0)return x.alloc(0);for(var d=x.allocUnsafe(f>>>0),v=this.head,b=0;v;)y(v.data,d,b),b+=v.data.length,v=v.next;return d}},{key:"consume",value:function(f,d){var v;return f<this.head.data.length?(v=this.head.data.slice(0,f),this.head.data=this.head.data.slice(f)):f===this.head.data.length?v=this.shift():v=d?this._getString(f):this._getBuffer(f),v}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(f){var d=this.head,v=1,b=d.data;for(f-=b.length;d=d.next;){var T=d.data,N=f>T.length?T.length:f;if(b+=N===T.length?T:T.slice(0,f),f-=N,f===0){N===T.length?(++v,this.head=d.next?d.next:this.tail=null):(this.head=d,d.data=T.slice(N));break}++v}return this.length-=v,b}},{key:"_getBuffer",value:function(f){var d=x.allocUnsafe(f),v=this.head,b=1;for(v.data.copy(d),f-=v.data.length;v=v.next;){var T=v.data,N=f>T.length?T.length:f;if(T.copy(d,d.length-f,0,N),f-=N,f===0){N===T.length?(++b,this.head=v.next?v.next:this.tail=null):(this.head=v,v.data=T.slice(N));break}++b}return this.length-=b,d}},{key:O,value:function(f,d){return k(this,a({},d,{depth:0,customInspect:!1}))}}]),l}()},{buffer:3,util:2}],23:[function(c,m){(function(p){(function(){"use strict";function a(i,g){A(i,g),_(i)}function _(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function A(i,g){i.emit("error",g)}m.exports={destroy:function(i,g){var y=this,u=this._readableState&&this._readableState.destroyed,x=this._writableState&&this._writableState.destroyed;return u||x?(g?g(i):i&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,p.nextTick(A,this,i)):p.nextTick(A,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(C){!g&&C?y._writableState?y._writableState.errorEmitted?p.nextTick(_,y):(y._writableState.errorEmitted=!0,p.nextTick(a,y,C)):p.nextTick(a,y,C):g?(p.nextTick(_,y),g(C)):p.nextTick(_,y)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(i,g){var y=i._readableState,u=i._writableState;y&&y.autoDestroy||u&&u.autoDestroy?i.destroy(g):i.emit("error",g)}}}).call(this)}).call(this,c("_process"))},{_process:12}],24:[function(c,m){"use strict";function p(g){var y=!1;return function(){if(!y){y=!0;for(var u=arguments.length,x=Array(u),C=0;C<u;C++)x[C]=arguments[C];g.apply(this,x)}}}function a(){}function _(g){return g.setHeader&&typeof g.abort=="function"}function A(g,y,u){if(typeof y=="function")return A(g,null,y);y||(y={}),u=p(u||a);var x=y.readable||y.readable!==!1&&g.readable,C=y.writable||y.writable!==!1&&g.writable,k=function(){g.writable||l()},O=g._writableState&&g._writableState.finished,l=function(){C=!1,O=!0,x||u.call(g)},f=g._readableState&&g._readableState.endEmitted,d=function(){x=!1,f=!0,C||u.call(g)},v=function(N){u.call(g,N)},b=function(){var N;return x&&!f?(g._readableState&&g._readableState.ended||(N=new i),u.call(g,N)):C&&!O?(g._writableState&&g._writableState.ended||(N=new i),u.call(g,N)):void 0},T=function(){g.req.on("finish",l)};return _(g)?(g.on("complete",l),g.on("abort",b),g.req?T():g.on("request",T)):C&&!g._writableState&&(g.on("end",k),g.on("close",k)),g.on("end",d),g.on("finish",l),y.error!==!1&&g.on("error",v),g.on("close",b),function(){g.removeListener("complete",l),g.removeListener("abort",b),g.removeListener("request",T),g.req&&g.req.removeListener("finish",l),g.removeListener("end",k),g.removeListener("close",k),g.removeListener("finish",l),g.removeListener("end",d),g.removeListener("error",v),g.removeListener("close",b)}}var i=c("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;m.exports=A},{"../../../errors":15}],25:[function(c,m){m.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(c,m){"use strict";function p(O){var l=!1;return function(){l||(l=!0,O.apply(void 0,arguments))}}function a(O){if(O)throw O}function _(O){return O.setHeader&&typeof O.abort=="function"}function A(O,l,f,d){d=p(d);var v=!1;O.on("close",function(){v=!0}),u===void 0&&(u=c("./end-of-stream")),u(O,{readable:l,writable:f},function(T){return T?d(T):(v=!0,void d())});var b=!1;return function(T){if(!v)return b?void 0:(b=!0,_(O)?O.abort():typeof O.destroy=="function"?O.destroy():void d(T||new k("pipe")))}}function i(O){O()}function g(O,l){return O.pipe(l)}function y(O){return O.length&&typeof O[O.length-1]=="function"?O.pop():a}var u,x=c("../../../errors").codes,C=x.ERR_MISSING_ARGS,k=x.ERR_STREAM_DESTROYED;m.exports=function(){for(var O=arguments.length,l=Array(O),f=0;f<O;f++)l[f]=arguments[f];var d=y(l);if(Array.isArray(l[0])&&(l=l[0]),2>l.length)throw new C("streams");var v,b=l.map(function(T,N){var w=N<l.length-1;return A(T,w,0<N,function(E){v||(v=E),E&&b.forEach(i),w||(b.forEach(i),d(v))})});return l.reduce(g)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(c,m){"use strict";function p(_,A,i){return _.highWaterMark==null?A?_[i]:null:_.highWaterMark}var a=c("../../../errors").codes.ERR_INVALID_OPT_VALUE;m.exports={getHighWaterMark:function(_,A,i,g){var y=p(A,g,i);if(y!=null){if(!(isFinite(y)&&r(y)===y)||0>y){var u=g?i:"highWaterMark";throw new a(u,y)}return r(y)}return _.objectMode?16:16384}}},{"../../../errors":15}],28:[function(c,m){m.exports=c("events").EventEmitter},{events:7}],29:[function(c,m,p){p=m.exports=c("./lib/_stream_readable.js"),p.Stream=p,p.Readable=p,p.Writable=c("./lib/_stream_writable.js"),p.Duplex=c("./lib/_stream_duplex.js"),p.Transform=c("./lib/_stream_transform.js"),p.PassThrough=c("./lib/_stream_passthrough.js"),p.finished=c("./lib/internal/streams/end-of-stream.js"),p.pipeline=c("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(c,m,p){function a(g,y){for(var u in g)y[u]=g[u]}function _(g,y,u){return i(g,y,u)}var A=c("buffer"),i=A.Buffer;i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?m.exports=A:(a(A,p),p.Buffer=_),_.prototype=Object.create(i.prototype),a(i,_),_.from=function(g,y,u){if(typeof g=="number")throw new TypeError("Argument must not be a number");return i(g,y,u)},_.alloc=function(g,y,u){if(typeof g!="number")throw new TypeError("Argument must be a number");var x=i(g);return y===void 0?x.fill(0):typeof u=="string"?x.fill(y,u):x.fill(y),x},_.allocUnsafe=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return i(g)},_.allocUnsafeSlow=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return A.SlowBuffer(g)}},{buffer:3}],31:[function(c,m,p){"use strict";function a(b){if(!b)return"utf8";for(var T;;)switch(b){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return b;default:if(T)return;b=(""+b).toLowerCase(),T=!0}}function _(b){var T=a(b);if(typeof T!="string"&&(d.isEncoding===v||!v(b)))throw new Error("Unknown encoding: "+b);return T||b}function A(b){this.encoding=_(b);var T;switch(this.encoding){case"utf16le":this.text=x,this.end=C,T=4;break;case"utf8":this.fillLast=u,T=4;break;case"base64":this.text=k,this.end=O,T=3;break;default:return this.write=l,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(T)}function i(b){return 127>=b?0:b>>5==6?2:b>>4==14?3:b>>3==30?4:b>>6==2?-1:-2}function g(b,T,N){var w=T.length-1;if(w<N)return 0;var E=i(T[w]);return 0<=E?(0<E&&(b.lastNeed=E-1),E):--w<N||E===-2?0:(E=i(T[w]),0<=E?(0<E&&(b.lastNeed=E-2),E):--w<N||E===-2?0:(E=i(T[w]),0<=E?(0<E&&(E===2?E=0:b.lastNeed=E-3),E):0))}function y(b,T){if((192&T[0])!=128)return b.lastNeed=0,"\uFFFD";if(1<b.lastNeed&&1<T.length){if((192&T[1])!=128)return b.lastNeed=1,"\uFFFD";if(2<b.lastNeed&&2<T.length&&(192&T[2])!=128)return b.lastNeed=2,"\uFFFD"}}function u(b){var T=this.lastTotal-this.lastNeed,N=y(this,b,T);return N===void 0?this.lastNeed<=b.length?(b.copy(this.lastChar,T,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(b.copy(this.lastChar,T,0,b.length),void(this.lastNeed-=b.length)):N}function x(b,T){if((b.length-T)%2==0){var N=b.toString("utf16le",T);if(N){var w=N.charCodeAt(N.length-1);if(55296<=w&&56319>=w)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1],N.slice(0,-1)}return N}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=b[b.length-1],b.toString("utf16le",T,b.length-1)}function C(b){var T=b&&b.length?this.write(b):"";if(this.lastNeed){var N=this.lastTotal-this.lastNeed;return T+this.lastChar.toString("utf16le",0,N)}return T}function k(b,T){var N=(b.length-T)%3;return N==0?b.toString("base64",T):(this.lastNeed=3-N,this.lastTotal=3,N==1?this.lastChar[0]=b[b.length-1]:(this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1]),b.toString("base64",T,b.length-N))}function O(b){var T=b&&b.length?this.write(b):"";return this.lastNeed?T+this.lastChar.toString("base64",0,3-this.lastNeed):T}function l(b){return b.toString(this.encoding)}function f(b){return b&&b.length?this.write(b):""}var d=c("safe-buffer").Buffer,v=d.isEncoding||function(b){switch(b=""+b,b&&b.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};p.StringDecoder=A,A.prototype.write=function(b){if(b.length===0)return"";var T,N;if(this.lastNeed){if(T=this.fillLast(b),T===void 0)return"";N=this.lastNeed,this.lastNeed=0}else N=0;return N<b.length?T?T+this.text(b,N):this.text(b,N):T||""},A.prototype.end=function(b){var T=b&&b.length?this.write(b):"";return this.lastNeed?T+"\uFFFD":T},A.prototype.text=function(b,T){var N=g(this,b,T);if(!this.lastNeed)return b.toString("utf8",T);this.lastTotal=N;var w=b.length-(N-this.lastNeed);return b.copy(this.lastChar,0,w),b.toString("utf8",T,w)},A.prototype.fillLast=function(b){return this.lastNeed<=b.length?(b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,b.length),void(this.lastNeed-=b.length))}},{"safe-buffer":30}],32:[function(c,m){(function(p){(function(){function a(_){try{if(!p.localStorage)return!1}catch{return!1}var A=p.localStorage[_];return A!=null&&(A+"").toLowerCase()==="true"}m.exports=function(_,A){function i(){if(!g){if(a("throwDeprecation"))throw new Error(A);a("traceDeprecation")?console.trace(A):console.warn(A),g=!0}return _.apply(this,arguments)}if(a("noDeprecation"))return _;var g=!1;return i}}).call(this)}).call(this,typeof globalThis>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:globalThis)},{}],"/":[function(c,m){function p(O){return O.replace(/a=ice-options:trickle\s\n/g,"")}function a(O){console.warn(O)}let _=c("debug")("simple-peer"),A=c("get-browser-rtc"),i=c("randombytes"),g=c("readable-stream"),y=c("queue-microtask"),u=c("err-code"),{Buffer:x}=c("buffer"),C=65536;class k extends g.Duplex{constructor(l){if(l=Object.assign({allowHalfOpen:!1},l),super(l),this._id=i(4).toString("hex").slice(0,7),this._debug("new peer %o",l),this.channelName=l.initiator?l.channelName||i(20).toString("hex"):null,this.initiator=l.initiator||!1,this.channelConfig=l.channelConfig||k.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},k.config,l.config),this.offerOptions=l.offerOptions||{},this.answerOptions=l.answerOptions||{},this.sdpTransform=l.sdpTransform||(f=>f),this.streams=l.streams||(l.stream?[l.stream]:[]),this.trickle=l.trickle===void 0||l.trickle,this.allowHalfTrickle=l.allowHalfTrickle!==void 0&&l.allowHalfTrickle,this.iceCompleteTimeout=l.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=l.wrtc&&typeof l.wrtc=="object"?l.wrtc:A(),!this._wrtc)throw u(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(f){return void this.destroy(u(f,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=f=>{this._onIceCandidate(f)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(f=>{this.destroy(u(f,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=f=>{this._setupData(f)},this.streams&&this.streams.forEach(f=>{this.addStream(f)}),this._pc.ontrack=f=>{this._onTrack(f)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(l){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof l=="string")try{l=JSON.parse(l)}catch{l={}}this._debug("signal()"),l.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),l.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(l.transceiverRequest.kind,l.transceiverRequest.init)),l.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(l.candidate):this._pendingCandidates.push(l.candidate)),l.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(l)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(f=>{this._addIceCandidate(f)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(f=>{this.destroy(u(f,"ERR_SET_REMOTE_DESCRIPTION"))}),l.sdp||l.candidate||l.renegotiate||l.transceiverRequest||this.destroy(u(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(l){let f=new this._wrtc.RTCIceCandidate(l);this._pc.addIceCandidate(f).catch(d=>{!f.address||f.address.endsWith(".local")?a("Ignoring unsupported ICE candidate."):this.destroy(u(d,"ERR_ADD_ICE_CANDIDATE"))})}send(l){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(l)}}addTransceiver(l,f){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(l,f),this._needsNegotiation()}catch(d){this.destroy(u(d,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:l,init:f}})}}addStream(l){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),l.getTracks().forEach(f=>{this.addTrack(f,l)})}}addTrack(l,f){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");let d=this._senderMap.get(l)||new Map,v=d.get(f);if(!v)v=this._pc.addTrack(l,f),d.set(f,v),this._senderMap.set(l,d),this._needsNegotiation();else throw v.removed?u(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):u(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(l,f,d){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");let v=this._senderMap.get(l),b=v?v.get(d):null;if(!b)throw u(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");f&&this._senderMap.set(f,v),b.replaceTrack==null?this.destroy(u(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):b.replaceTrack(f)}removeTrack(l,f){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");let d=this._senderMap.get(l),v=d?d.get(f):null;if(!v)throw u(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{v.removed=!0,this._pc.removeTrack(v)}catch(b){b.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(v):this.destroy(u(b,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(l){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),l.getTracks().forEach(f=>{this.removeTrack(f,l)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,y(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(l){this._destroy(l,()=>{})}_destroy(l,f){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",l&&(l.message||l)),y(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",l&&(l.message||l)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,l&&this.emit("error",l),this.emit("close"),f()}))}_setupData(l){if(!l.channel)return this.destroy(u(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=l.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=C),this.channelName=this._channel.label,this._channel.onmessage=d=>{this._onChannelMessage(d)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=d=>{let v=d.error instanceof Error?d.error:new Error(`Datachannel error: ${d.message} ${d.filename}:${d.lineno}:${d.colno}`);this.destroy(u(v,"ERR_DATA_CHANNEL"))};let f=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(f&&this._onChannelClose(),f=!0):f=!1},5e3)}_read(){}_write(l,f,d){if(this.destroyed)return d(u(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(l)}catch(v){return this.destroy(u(v,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>C?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=d):d(null)}else this._debug("write before connect"),this._chunk=l,this._cb=d}_onFinish(){if(!this.destroyed){let l=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?l():this.once("connect",l)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(l=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(l.sdp=p(l.sdp)),l.sdp=this.sdpTransform(l.sdp);let f=()=>{if(!this.destroyed){let d=this._pc.localDescription||l;this._debug("signal"),this.emit("signal",{type:d.type,sdp:d.sdp})}};this._pc.setLocalDescription(l).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?f():this.once("_iceComplete",f))}).catch(d=>{this.destroy(u(d,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(l=>{this.destroy(u(l,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(l=>{l.mid||!l.sender.track||l.requested||(l.requested=!0,this.addTransceiver(l.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(l=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(l.sdp=p(l.sdp)),l.sdp=this.sdpTransform(l.sdp);let f=()=>{if(!this.destroyed){let d=this._pc.localDescription||l;this._debug("signal"),this.emit("signal",{type:d.type,sdp:d.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(l).then(()=>{this.destroyed||(this.trickle||this._iceComplete?f():this.once("_iceComplete",f))}).catch(d=>{this.destroy(u(d,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(l=>{this.destroy(u(l,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(u(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;let l=this._pc.iceConnectionState,f=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",l,f),this.emit("iceStateChange",l,f),(l==="connected"||l==="completed")&&(this._pcReady=!0,this._maybeReady()),l==="failed"&&this.destroy(u(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),l==="closed"&&this.destroy(u(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(l){let f=d=>(Object.prototype.toString.call(d.values)==="[object Array]"&&d.values.forEach(v=>{Object.assign(d,v)}),d);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(d=>{let v=[];d.forEach(b=>{v.push(f(b))}),l(null,v)},d=>l(d)):0<this._pc.getStats.length?this._pc.getStats(d=>{if(this.destroyed)return;let v=[];d.result().forEach(b=>{let T={};b.names().forEach(N=>{T[N]=b.stat(N)}),T.id=b.id,T.type=b.type,T.timestamp=b.timestamp,v.push(f(T))}),l(null,v)},d=>l(d)):l(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let l=()=>{this.destroyed||this.getStats((f,d)=>{if(this.destroyed)return;f&&(d=[]);let v={},b={},T={},N=!1;d.forEach(E=>{(E.type==="remotecandidate"||E.type==="remote-candidate")&&(v[E.id]=E),(E.type==="localcandidate"||E.type==="local-candidate")&&(b[E.id]=E),(E.type==="candidatepair"||E.type==="candidate-pair")&&(T[E.id]=E)});let w=E=>{N=!0;let I=b[E.localCandidateId];I&&(I.ip||I.address)?(this.localAddress=I.ip||I.address,this.localPort=+I.port):I&&I.ipAddress?(this.localAddress=I.ipAddress,this.localPort=+I.portNumber):typeof E.googLocalAddress=="string"&&(I=E.googLocalAddress.split(":"),this.localAddress=I[0],this.localPort=+I[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let M=v[E.remoteCandidateId];M&&(M.ip||M.address)?(this.remoteAddress=M.ip||M.address,this.remotePort=+M.port):M&&M.ipAddress?(this.remoteAddress=M.ipAddress,this.remotePort=+M.portNumber):typeof E.googRemoteAddress=="string"&&(M=E.googRemoteAddress.split(":"),this.remoteAddress=M[0],this.remotePort=+M[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(d.forEach(E=>{E.type==="transport"&&E.selectedCandidatePairId&&w(T[E.selectedCandidatePairId]),(E.type==="googCandidatePair"&&E.googActiveConnection==="true"||(E.type==="candidatepair"||E.type==="candidate-pair")&&E.selected)&&w(E)}),!N&&(!Object.keys(T).length||Object.keys(b).length))return void setTimeout(l,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(I){return this.destroy(u(I,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');let E=this._cb;this._cb=null,E(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};l()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>C)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(l=>{this._pc.removeTrack(l),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(l){this.destroyed||(l.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:l.candidate.candidate,sdpMLineIndex:l.candidate.sdpMLineIndex,sdpMid:l.candidate.sdpMid}}):!l.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),l.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(l){if(this.destroyed)return;let f=l.data;f instanceof ArrayBuffer&&(f=x.from(f)),this.push(f)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);let l=this._cb;this._cb=null,l(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(l){this.destroyed||l.streams.forEach(f=>{this._debug("on track"),this.emit("track",l.track,f),this._remoteTracks.push({track:l.track,stream:f}),this._remoteStreams.some(d=>d.id===f.id)||(this._remoteStreams.push(f),y(()=>{this._debug("on stream"),this.emit("stream",f)}))})}_debug(){let l=[].slice.call(arguments);l[0]="["+this._id+"] "+l[0],_.apply(null,l)}}k.WEBRTC_SUPPORT=!!A(),k.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},k.channelConfig={},m.exports=k},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})});var st=()=>new Map;var wt=(r,o,s)=>{let c=r.get(o);return c===void 0&&r.set(o,c=s()),c},wr=(r,o)=>{let s=[];for(let[c,m]of r)s.push(o(m,c));return s};var At=()=>new Set;var Oe=Array.from;var _r=Array.isArray;var le=class{constructor(){this._observers=st()}on(o,s){return wt(this._observers,o,At).add(s),s}once(o,s){let c=(...m)=>{this.off(o,c),s(...m)};this.on(o,c)}off(o,s){let c=this._observers.get(o);c!==void 0&&(c.delete(s),c.size===0&&this._observers.delete(o))}emit(o,s){return Oe((this._observers.get(o)||st()).values()).forEach(c=>c(...s))}destroy(){this._observers=st()}},Ft=class{constructor(){this._observers=st()}on(o,s){wt(this._observers,o,At).add(s)}once(o,s){let c=(...m)=>{this.off(o,c),s(...m)};this.on(o,c)}off(o,s){let c=this._observers.get(o);c!==void 0&&(c.delete(s),c.size===0&&this._observers.delete(o))}emit(o,s){return Oe((this._observers.get(o)||st()).values()).forEach(c=>c(...s))}destroy(){this._observers=st()}};var ft=Math.floor;var Er=Math.abs;var xr=Math.log10;var ue=(r,o)=>r<o?r:o,Ne=(r,o)=>r>o?r:o,Go=Number.isNaN;var Sr=r=>r!==0?r<0:1/r<0;var ct=Date.now;var Ln=1200,On=2500,he=3e4,Be=r=>{if(r.shouldConnect&&r.ws===null){let o=new WebSocket(r.url),s=r.binaryType,c=null;s&&(o.binaryType=s),r.ws=o,r.connecting=!0,r.connected=!1,o.onmessage=a=>{r.lastMessageReceived=ct();let _=a.data,A=typeof _=="string"?JSON.parse(_):_;A&&A.type==="pong"&&(clearTimeout(c),c=setTimeout(p,he/2)),r.emit("message",[A,r])};let m=a=>{r.ws!==null&&(r.ws=null,r.connecting=!1,r.connected?(r.connected=!1,r.emit("disconnect",[{type:"disconnect",error:a},r])):r.unsuccessfulReconnects++,setTimeout(Be,ue(xr(r.unsuccessfulReconnects+1)*Ln,On),r)),clearTimeout(c)},p=()=>{r.ws===o&&r.send({type:"ping"})};o.onclose=()=>m(null),o.onerror=a=>m(a),o.onopen=()=>{r.lastMessageReceived=ct(),r.connecting=!1,r.connected=!0,r.unsuccessfulReconnects=0,r.emit("connect",[{type:"connect"},r]),c=setTimeout(p,he/2)}}},fe=class extends Ft{constructor(o,{binaryType:s}={}){super(),this.url=o,this.ws=null,this.binaryType=s||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&he<ct()-this.lastMessageReceived&&this.ws.close()},he/2),Be(this)}send(o){this.ws&&this.ws.send(JSON.stringify(o))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Be(this)}};var Ut=r=>new Error(r);var $o=crypto.subtle,Cr=crypto.getRandomValues.bind(crypto);var Tr=Math.random,In=()=>Cr(new Uint32Array(1))[0];var Bn="10000000-1000-4000-8000"+-1e11,Rr=()=>Bn.replace(/[018]/g,r=>(r^In()&15>>r/4).toString(16));var Me=Number.MAX_SAFE_INTEGER,Xo=Number.MIN_SAFE_INTEGER,Zo=1<<31;var Ar=Number.isInteger||(r=>typeof r=="number"&&isFinite(r)&&ft(r)===r),Qo=Number.isNaN,ti=Number.parseInt;var Pe=String.fromCharCode,ei=String.fromCodePoint,ri=Pe(65535),Mn=r=>r.toLowerCase(),Pn=/^\s*/g,Fn=r=>r.replace(Pn,""),jn=/([A-Z])/g,Fe=(r,o)=>Fn(r.replace(jn,s=>`${o}${Mn(s)}`));var Vn=r=>{let o=unescape(encodeURIComponent(r)),s=o.length,c=new Uint8Array(s);for(let m=0;m<s;m++)c[m]=o.codePointAt(m);return c},Vt=typeof TextEncoder<"u"?new TextEncoder:null,qn=r=>Vt.encode(r),te=Vt?qn:Vn;var jt=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});jt&&jt.decode(new Uint8Array).length===1&&(jt=null);var je=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},tt=()=>new je;var Hn=r=>{let o=r.cpos;for(let s=0;s<r.bufs.length;s++)o+=r.bufs[s].length;return o};var et=r=>{let o=new Uint8Array(Hn(r)),s=0;for(let c=0;c<r.bufs.length;c++){let m=r.bufs[c];o.set(m,s),s+=m.length}return o.set(new Uint8Array(r.cbuf.buffer,0,r.cpos),s),o},Yn=(r,o)=>{let s=r.cbuf.length;s-r.cpos<o&&(r.bufs.push(new Uint8Array(r.cbuf.buffer,0,r.cpos)),r.cbuf=new Uint8Array(Ne(s,o)*2),r.cpos=0)},Q=(r,o)=>{let s=r.cbuf.length;r.cpos===s&&(r.bufs.push(r.cbuf),r.cbuf=new Uint8Array(s*2),r.cpos=0),r.cbuf[r.cpos++]=o};var qe=Q;var $=(r,o)=>{for(;o>127;)Q(r,128|127&o),o=ft(o/128);Q(r,127&o)},Gn=(r,o)=>{let s=Sr(o);for(s&&(o=-o),Q(r,(o>63?128:0)|(s?64:0)|63&o),o=ft(o/64);o>0;)Q(r,(o>127?128:0)|127&o),o=ft(o/128)},Ve=new Uint8Array(3e4),zn=Ve.length/3,$n=(r,o)=>{if(o.length<zn){let s=Vt.encodeInto(o,Ve).written||0;$(r,s);for(let c=0;c<s;c++)Q(r,Ve[c])}else ot(r,te(o))},Kn=(r,o)=>{let s=unescape(encodeURIComponent(o)),c=s.length;$(r,c);for(let m=0;m<c;m++)Q(r,s.codePointAt(m))},_t=Vt&&Vt.encodeInto?$n:Kn;var Jn=(r,o)=>{let s=r.cbuf.length,c=r.cpos,m=ue(s-c,o.length),p=o.length-m;r.cbuf.set(o.subarray(0,m),c),r.cpos+=m,p>0&&(r.bufs.push(r.cbuf),r.cbuf=new Uint8Array(Ne(s*2,p)),r.cbuf.set(o.subarray(m)),r.cpos=p)},ot=(r,o)=>{$(r,o.byteLength),Jn(r,o)},We=(r,o)=>{Yn(r,o);let s=new DataView(r.cbuf.buffer,r.cpos,o);return r.cpos+=o,s},Xn=(r,o)=>We(r,4).setFloat32(0,o,!1),Zn=(r,o)=>We(r,8).setFloat64(0,o,!1),Qn=(r,o)=>We(r,8).setBigInt64(0,o,!1);var Lr=new DataView(new ArrayBuffer(4)),to=r=>(Lr.setFloat32(0,r),Lr.getFloat32(0)===r),de=(r,o)=>{switch(typeof o){case"string":Q(r,119),_t(r,o);break;case"number":Ar(o)&&Er(o)<=2147483647?(Q(r,125),Gn(r,o)):to(o)?(Q(r,124),Xn(r,o)):(Q(r,123),Zn(r,o));break;case"bigint":Q(r,122),Qn(r,o);break;case"object":if(o===null)Q(r,126);else if(_r(o)){Q(r,117),$(r,o.length);for(let s=0;s<o.length;s++)de(r,o[s])}else if(o instanceof Uint8Array)Q(r,116),ot(r,o);else{Q(r,118);let s=Object.keys(o);$(r,s.length);for(let c=0;c<s.length;c++){let m=s[c];_t(r,m),de(r,o[m])}}break;case"boolean":Q(r,o?120:121);break;default:Q(r,127)}};var Or=Ut("Unexpected end of array"),Nr=Ut("Integer out of Range"),He=class{constructor(o){this.arr=o,this.pos=0}},kt=r=>new He(r);var eo=(r,o)=>{let s=new Uint8Array(r.arr.buffer,r.pos+r.arr.byteOffset,o);return r.pos+=o,s},dt=r=>eo(r,lt(r));var ne=r=>r.arr[r.pos++];var lt=r=>{let o=0,s=1,c=r.arr.length;for(;r.pos<c;){let m=r.arr[r.pos++];if(o=o+(m&127)*s,s*=128,m<128)return o;if(o>Me)throw Nr}throw Or},ro=r=>{let o=r.arr[r.pos++],s=o&63,c=64,m=(o&64)>0?-1:1;if(!(o&128))return m*s;let p=r.arr.length;for(;r.pos<p;){if(o=r.arr[r.pos++],s=s+(o&127)*c,c*=128,o<128)return m*s;if(s>Me)throw Nr}throw Or};var no=r=>{let o=lt(r);if(o===0)return"";{let s=String.fromCodePoint(ne(r));if(--o<100)for(;o--;)s+=String.fromCodePoint(ne(r));else for(;o>0;){let c=o<1e4?o:1e4,m=r.arr.subarray(r.pos,r.pos+c);r.pos+=c,s+=String.fromCodePoint.apply(null,m),o-=c}return decodeURIComponent(escape(s))}},oo=r=>jt.decode(dt(r)),Ct=jt?oo:no;var Ye=(r,o)=>{let s=new DataView(r.arr.buffer,r.arr.byteOffset+r.pos,o);return r.pos+=o,s},io=r=>Ye(r,4).getFloat32(0,!1),so=r=>Ye(r,8).getFloat64(0,!1),ao=r=>Ye(r,8).getBigInt64(0,!1);var co=[r=>{},r=>null,ro,io,so,ao,r=>!1,r=>!0,Ct,r=>{let o=lt(r),s={};for(let c=0;c<o;c++){let m=Ct(r);s[m]=ge(r)}return s},r=>{let o=lt(r),s=[];for(let c=0;c<o;c++)s.push(ge(r));return s},dt],ge=r=>co[127-ne(r)](r);var Ge=r=>r===void 0?null:r;var ze=class{constructor(){this.map=new Map}setItem(o,s){this.map.set(o,s)}getItem(o){return this.map.get(o)}},Ir=new ze,$e=!0;try{typeof localStorage<"u"&&localStorage&&(Ir=localStorage,$e=!1)}catch{}var ye=Ir,Br=r=>$e||addEventListener("storage",r),Dr=r=>$e||removeEventListener("storage",r);var uo=Object.keys;var Ke=r=>uo(r).length;var Pr=(r,o)=>Object.prototype.hasOwnProperty.call(r,o);var Fr=()=>{};var fo=(r,o)=>r===o;var Wt=(r,o)=>{if(r==null||o==null)return fo(r,o);if(r.constructor!==o.constructor)return!1;if(r===o)return!0;switch(r.constructor){case ArrayBuffer:r=new Uint8Array(r),o=new Uint8Array(o);case Uint8Array:{if(r.byteLength!==o.byteLength)return!1;for(let s=0;s<r.length;s++)if(r[s]!==o[s])return!1;break}case Set:{if(r.size!==o.size)return!1;for(let s of r)if(!o.has(s))return!1;break}case Map:{if(r.size!==o.size)return!1;for(let s of r.keys())if(!o.has(s)||!Wt(r.get(s),o.get(s)))return!1;break}case Object:if(Ke(r)!==Ke(o))return!1;for(let s in r)if(!Pr(r,s)||!Wt(r[s],o[s]))return!1;break;case Array:if(r.length!==o.length)return!1;for(let s=0;s<r.length;s++)if(!Wt(r[s],o[s]))return!1;break;default:return!1}return!0},jr=(r,o)=>o.includes(r);var Ht=typeof __Process$<"u"&&__Process$.release&&/node|io\.js/.test(__Process$.release.name)&&Object.prototype.toString.call(typeof __Process$<"u"?__Process$:0)==="[object process]",be=typeof window<"u"&&typeof document<"u"&&!Ht,si=typeof navigator<"u"?/Mac/.test(navigator.platform):!1,pt,po=[],go=()=>{if(pt===void 0)if(Ht){pt=st();let r=__Process$.argv,o=null;for(let s=0;s<r.length;s++){let c=r[s];c[0]==="-"?(o!==null&&pt.set(o,""),o=c):o!==null?(pt.set(o,c),o=null):po.push(c)}o!==null&&pt.set(o,"")}else typeof location=="object"?(pt=st(),(location.search||"?").slice(1).split("&").forEach(r=>{if(r.length!==0){let[o,s]=r.split("=");pt.set(`--${Fe(o,"-")}`,s),pt.set(`-${Fe(o,"-")}`,s)}})):pt=st();return pt},Xe=r=>go().has(r);var oe=r=>Ht?Ge(__Process$.env[r.toUpperCase().replaceAll("-","_")]):Ge(ye.getItem(r));var Vr=r=>Xe("--"+r)||oe(r)!==null,ai=Vr("production"),mo=Ht&&jr(__Process$.env.FORCE_COLOR,["true","1","2"]),qr=mo||!Xe("--no-colors")&&!Vr("no-color")&&(!Ht||__Process$.stdout.isTTY)&&(!Ht||Xe("--color")||oe("COLORTERM")!==null||(oe("TERM")||"").includes("color"));var Qe=class{constructor(o,s){this.left=o,this.right=s}},gt=(r,o)=>new Qe(r,o);var Lt=typeof document<"u"?document:{};var ci=typeof DOMParser<"u"?new DOMParser:null;var Wr=r=>wr(r,(o,s)=>`${s}:${o};`).join("");var li=Lt.ELEMENT_NODE,ui=Lt.TEXT_NODE,hi=Lt.CDATA_SECTION_NODE,fi=Lt.COMMENT_NODE,di=Lt.DOCUMENT_NODE,pi=Lt.DOCUMENT_TYPE_NODE,gi=Lt.DOCUMENT_FRAGMENT_NODE;var Hr=JSON.stringify;var mt=Symbol;var it=mt(),vt=mt(),we=mt(),Yt=mt(),_e=mt(),er=mt(),ve=mt(),Ee=mt(),Ot=mt(),zr=r=>{r.length===1&&r[0]?.constructor===Function&&(r=r[0]());let o=[],s=[],c=0;for(;c<r.length;c++){let m=r[c];if(m===void 0)break;if(m.constructor===String||m.constructor===Number)o.push(m);else if(m.constructor===Object)break}for(c>0&&s.push(o.join(""));c<r.length;c++){let m=r[c];m instanceof Symbol||s.push(m)}return s},Yr=[_e,ve,Ee,we],tr=0,Gr=ct(),$r=(r,o)=>{let s=Yr[tr],c=oe("log"),m=c!==null&&(c==="*"||c==="true"||new RegExp(c,"gi").test(o));return tr=(tr+1)%Yr.length,o+=": ",m?(...p)=>{p.length===1&&p[0]?.constructor===Function&&(p=p[0]());let a=ct(),_=a-Gr;Gr=a,r(s,o,Ot,...p.map(A=>{switch(A!=null&&A.constructor===Uint8Array&&(A=Array.from(A)),typeof A){case"string":case"symbol":return A;default:return Hr(A)}}),s," +"+_+"ms")}:Fr};var Eo={[it]:gt("font-weight","bold"),[vt]:gt("font-weight","normal"),[we]:gt("color","blue"),[_e]:gt("color","green"),[Yt]:gt("color","grey"),[er]:gt("color","red"),[ve]:gt("color","purple"),[Ee]:gt("color","orange"),[Ot]:gt("color","black")},xo=r=>{r.length===1&&r[0]?.constructor===Function&&(r=r[0]());let o=[],s=[],c=st(),m=[],p=0;for(;p<r.length;p++){let a=r[p],_=Eo[a];if(_!==void 0)c.set(_.left,_.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){let A=Wr(c);p>0||A.length>0?(o.push("%c"+a),s.push(A)):o.push(a)}else break}}for(p>0&&(m=s,m.unshift(o.join("")));p<r.length;p++){let a=r[p];a instanceof Symbol||m.push(a)}return m},So=qr?xo:zr,Co=(...r)=>{console.log(...So(r)),To.forEach(o=>o.print(r))};var To=At();var Kr=r=>$r(Co,r);var vi=Promise.all.bind(Promise),Jr=r=>Promise.reject(r),ie=r=>Promise.resolve(r);var Ao=r=>new Uint8Array(r),Uo=(r,o,s)=>new Uint8Array(r,o,s),Zr=r=>new Uint8Array(r),ko=r=>{let o="";for(let s=0;s<r.byteLength;s++)o+=Pe(r[s]);return btoa(o)},Lo=r=>__Buffer$.from(r.buffer,r.byteOffset,r.byteLength).toString("base64"),Oo=r=>{let o=atob(r),s=Ao(o.length);for(let c=0;c<o.length;c++)s[c]=o.charCodeAt(c);return s},No=r=>{let o=__Buffer$.from(r,"base64");return Uo(o.buffer,o.byteOffset,o.byteLength)},xe=be?ko:Lo,Se=be?Oo:No;var tn=new Map,rr=class{constructor(o){this.room=o,this.onmessage=null,this._onChange=s=>s.key===o&&this.onmessage!==null&&this.onmessage({data:Se(s.newValue||"")}),Br(this._onChange)}postMessage(o){ye.setItem(this.room,xe(Zr(o)))}close(){Dr(this._onChange)}},Io=typeof BroadcastChannel>"u"?rr:BroadcastChannel,nr=r=>wt(tn,r,()=>{let o=At(),s=new Io(r);return s.onmessage=c=>o.forEach(m=>m(c.data,"broadcastchannel")),{bc:s,subs:o}}),en=(r,o)=>(nr(r).subs.add(o),o),rn=(r,o)=>{let s=nr(r),c=s.subs.delete(o);return c&&s.subs.size===0&&(s.bc.close(),tn.delete(r)),c},nn=(r,o,s=null)=>{let c=nr(r);c.bc.postMessage(o),c.subs.forEach(m=>m(o,s))};var on=()=>{let r=!0;return(o,s)=>{if(r){r=!1;try{o()}finally{r=!0}}else s!==void 0&&s()}};var bn=kn(an());import"./yjs.js";import*as Gt from"./yjs.js";var Ce=0,Te=1,cn=2,ir=(r,o)=>{$(r,Ce);let s=Gt.encodeStateVector(o);ot(r,s)},sr=(r,o,s)=>{$(r,Te),ot(r,Gt.encodeStateAsUpdate(o,s))},Do=(r,o,s)=>sr(o,s,dt(r)),ln=(r,o,s)=>{try{Gt.applyUpdate(o,dt(r),s)}catch(c){console.error("Caught error while handling a Yjs update",c)}},un=(r,o)=>{$(r,cn),ot(r,o)},Mo=ln,hn=(r,o,s,c)=>{let m=lt(r);switch(m){case Ce:Do(r,o,s);break;case Te:ln(r,s,c);break;case cn:Mo(r,s,c);break;default:throw new Error("Unknown message type")}return m};import"./yjs.js";var ar=3e4,Re=class extends Ft{constructor(o){super(),this.doc=o,this.clientID=o.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let s=ct();this.getLocalState()!==null&&ar/2<=s-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let c=[];this.meta.forEach((m,p)=>{p!==this.clientID&&ar<=s-m.lastUpdated&&this.states.has(p)&&c.push(p)}),c.length>0&&Ae(this,c,"timeout")},ft(ar/10)),o.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(o){let s=this.clientID,c=this.meta.get(s),m=c===void 0?0:c.clock+1,p=this.states.get(s);o===null?this.states.delete(s):this.states.set(s,o),this.meta.set(s,{clock:m,lastUpdated:ct()});let a=[],_=[],A=[],i=[];o===null?i.push(s):p==null?o!=null&&a.push(s):(_.push(s),Wt(p,o)||A.push(s)),(a.length>0||A.length>0||i.length>0)&&this.emit("change",[{added:a,updated:A,removed:i},"local"]),this.emit("update",[{added:a,updated:_,removed:i},"local"])}setLocalStateField(o,s){let c=this.getLocalState();c!==null&&this.setLocalState({...c,[o]:s})}getStates(){return this.states}},Ae=(r,o,s)=>{let c=[];for(let m=0;m<o.length;m++){let p=o[m];if(r.states.has(p)){if(r.states.delete(p),p===r.clientID){let a=r.meta.get(p);r.meta.set(p,{clock:a.clock+1,lastUpdated:ct()})}c.push(p)}}c.length>0&&(r.emit("change",[{added:[],updated:[],removed:c},s]),r.emit("update",[{added:[],updated:[],removed:c},s]))},se=(r,o,s=r.states)=>{let c=o.length,m=tt();$(m,c);for(let p=0;p<c;p++){let a=o[p],_=s.get(a)||null,A=r.meta.get(a).clock;$(m,a),$(m,A),_t(m,JSON.stringify(_))}return et(m)};var fn=(r,o,s)=>{let c=kt(o),m=ct(),p=[],a=[],_=[],A=[],i=lt(c);for(let g=0;g<i;g++){let y=lt(c),u=lt(c),x=JSON.parse(Ct(c)),C=r.meta.get(y),k=r.states.get(y),O=C===void 0?0:C.clock;(O<u||O===u&&x===null&&r.states.has(y))&&(x===null?y===r.clientID&&r.getLocalState()!=null?u++:r.states.delete(y):r.states.set(y,x),r.meta.set(y,{clock:u,lastUpdated:m}),C===void 0&&x!==null?p.push(y):C!==void 0&&x===null?A.push(y):x!==null&&(Wt(x,k)||_.push(y),a.push(y)))}(p.length>0||_.length>0||A.length>0)&&r.emit("change",[{added:p,updated:_,removed:A},s]),(p.length>0||a.length>0||A.length>0)&&r.emit("update",[{added:p,updated:a,removed:A},s])};var dn=(r,o)=>{let s=te(r).buffer,c=te(o).buffer;return crypto.subtle.importKey("raw",s,"PBKDF2",!1,["deriveKey"]).then(m=>crypto.subtle.deriveKey({name:"PBKDF2",salt:c,iterations:1e5,hash:"SHA-256"},m,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},cr=(r,o)=>{if(!o)return ie(r);let s=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:s},o,r).then(c=>{let m=tt();return _t(m,"AES-GCM"),ot(m,s),ot(m,new Uint8Array(c)),et(m)})},pn=(r,o)=>{let s=tt();return de(s,r),cr(et(s),o)},lr=(r,o)=>{if(!o)return ie(r);let s=kt(r);Ct(s)!=="AES-GCM"&&Jr(Ut("Unknown encryption algorithm"));let m=dt(s),p=dt(s);return crypto.subtle.decrypt({name:"AES-GCM",iv:m},o,p).then(a=>new Uint8Array(a))},gn=(r,o)=>lr(r,o).then(s=>ge(kt(new Uint8Array(s))));var at=Kr("y-webrtc"),zt=0,wn=3,ae=1,gr=4,Ue=new Map,Nt=new Map,_n=r=>{let o=!0;r.webrtcConns.forEach(s=>{s.synced||(o=!1)}),(!o&&r.synced||o&&!r.synced)&&(r.synced=o,r.provider.emit("synced",[{synced:o}]),at("synced ",it,r.name,vt," with all peers"))},vn=(r,o,s)=>{let c=kt(o),m=tt(),p=lt(c);if(r===void 0)return null;let a=r.awareness,_=r.doc,A=!1;switch(p){case zt:{$(m,zt);let i=hn(c,m,_,r);i===Te&&!r.synced&&s(),i===Ce&&(A=!0);break}case wn:$(m,ae),ot(m,se(a,Array.from(a.getStates().keys()))),A=!0;break;case ae:fn(a,dt(c),r);break;case gr:{let i=ne(c)===1,g=Ct(c);if(g!==r.peerId&&(r.bcConns.has(g)&&!i||!r.bcConns.has(g)&&i)){let y=[],u=[];i?(r.bcConns.add(g),u.push(g)):(r.bcConns.delete(g),y.push(g)),r.provider.emit("peers",[{added:u,removed:y,webrtcPeers:Array.from(r.webrtcConns.keys()),bcPeers:Array.from(r.bcConns)}]),En(r)}break}default:return console.error("Unable to compute message"),m}return A?m:null},Vo=(r,o)=>{let s=r.room;return at("received message from ",it,r.remotePeerId,Yt," (",s.name,")",vt,Ot),vn(s,o,()=>{r.synced=!0,at("synced ",it,s.name,vt," with ",it,r.remotePeerId),_n(s)})},ur=(r,o)=>{at("send message to ",it,r.remotePeerId,vt,Yt," (",r.room.name,")",Ot);try{r.peer.send(et(o))}catch{}},qo=(r,o)=>{at("broadcast message in ",it,r.name,vt),r.webrtcConns.forEach(s=>{try{s.peer.send(o)}catch{}})},ke=class{constructor(o,s,c,m){at("establishing connection to ",it,c),this.room=m,this.remotePeerId=c,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new bn.default({initiator:s,...m.provider.peerOpts}),this.peer.on("signal",p=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),mr(o,m,{to:c,from:m.peerId,type:"signal",token:this.glareToken,signal:p})}),this.peer.on("connect",()=>{at("connected to ",it,c),this.connected=!0;let a=m.provider.doc,_=m.awareness,A=tt();$(A,zt),ir(A,a),ur(this,A);let i=_.getStates();if(i.size>0){let g=tt();$(g,ae),ot(g,se(_,Array.from(i.keys()))),ur(this,g)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,m.webrtcConns.has(this.remotePeerId)&&(m.webrtcConns.delete(this.remotePeerId),m.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(m.webrtcConns.keys()),bcPeers:Array.from(m.bcConns)}])),_n(m),this.peer.destroy(),at("closed connection to ",it,c),fr(m)}),this.peer.on("error",p=>{at("Error in connection to ",it,c,": ",p),fr(m)}),this.peer.on("data",p=>{let a=Vo(this,p);a!==null&&ur(this,a)})}destroy(){this.peer.destroy()}},Tt=(r,o)=>cr(o,r.key).then(s=>r.mux(()=>nn(r.name,s))),mn=(r,o)=>{r.bcconnected&&Tt(r,o),qo(r,o)},fr=r=>{Ue.forEach(o=>{o.connected&&(o.send({type:"subscribe",topics:[r.name]}),r.webrtcConns.size<r.provider.maxConns&&mr(o,r,{type:"announce",from:r.peerId}))})},En=r=>{if(r.provider.filterBcConns){let o=tt();$(o,gr),qe(o,1),_t(o,r.peerId),Tt(r,et(o))}},dr=class{constructor(o,s,c,m){this.peerId=Rr(),this.doc=o,this.awareness=s.awareness,this.provider=s,this.synced=!1,this.name=c,this.key=m,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=on(),this.bcconnected=!1,this._bcSubscriber=p=>lr(new Uint8Array(p),m).then(a=>this.mux(()=>{let _=vn(this,a,()=>{});_&&Tt(this,et(_))})),this._docUpdateHandler=(p,a)=>{let _=tt();$(_,zt),un(_,p),mn(this,et(_))},this._awarenessUpdateHandler=({added:p,updated:a,removed:_},A)=>{let i=p.concat(a).concat(_),g=tt();$(g,ae),ot(g,se(this.awareness,i)),mn(this,et(g))},this._beforeUnloadHandler=()=>{Ae(this.awareness,[o.clientID],"window unload"),Nt.forEach(p=>{p.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof __Process$<"u"&&__Process$.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),fr(this);let o=this.name;en(o,this._bcSubscriber),this.bcconnected=!0,En(this);let s=tt();$(s,zt),ir(s,this.doc),Tt(this,et(s));let c=tt();$(c,zt),sr(c,this.doc),Tt(this,et(c));let m=tt();$(m,wn),Tt(this,et(m));let p=tt();$(p,ae),ot(p,se(this.awareness,[this.doc.clientID])),Tt(this,et(p))}disconnect(){Ue.forEach(s=>{s.connected&&s.send({type:"unsubscribe",topics:[this.name]})}),Ae(this.awareness,[this.doc.clientID],"disconnect");let o=tt();$(o,gr),qe(o,0),_t(o,this.peerId),Tt(this,et(o)),rn(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(s=>s.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof __Process$<"u"&&__Process$.off("exit",this._beforeUnloadHandler)}},Wo=(r,o,s,c)=>{if(Nt.has(s))throw Ut(`A Yjs Doc connected to room "${s}" already exists!`);let m=new dr(r,o,s,c);return Nt.set(s,m),m},mr=(r,o,s)=>{o.key?pn(s,o.key).then(c=>{r.send({type:"publish",topic:o.name,data:xe(c)})}):r.send({type:"publish",topic:o.name,data:s})},pr=class extends fe{constructor(o){super(o),this.providers=new Set,this.on("connect",()=>{at(`connected (${o})`);let s=Array.from(Nt.keys());this.send({type:"subscribe",topics:s}),Nt.forEach(c=>mr(this,c,{type:"announce",from:c.peerId}))}),this.on("message",s=>{switch(s.type){case"publish":{let c=s.topic,m=Nt.get(c);if(m==null||typeof c!="string")return;let p=a=>{let _=m.webrtcConns,A=m.peerId;if(a==null||a.from===A||a.to!==void 0&&a.to!==A||m.bcConns.has(a.from))return;let i=_.has(a.from)?()=>{}:()=>m.provider.emit("peers",[{removed:[],added:[a.from],webrtcPeers:Array.from(m.webrtcConns.keys()),bcPeers:Array.from(m.bcConns)}]);switch(a.type){case"announce":_.size<m.provider.maxConns&&(wt(_,a.from,()=>new ke(this,!0,a.from,m)),i());break;case"signal":if(a.signal.type==="offer"){let g=_.get(a.from);if(g){let y=a.token,u=g.glareToken;if(u&&u>y){at("offer rejected: ",a.from);return}g.glareToken=void 0}}if(a.signal.type==="answer"){at("offer answered by: ",a.from);let g=_.get(a.from);g.glareToken=void 0}a.to===A&&(wt(_,a.from,()=>new ke(this,!1,a.from,m)).peer.signal(a.signal),i());break}};m.key?typeof s.data=="string"&&gn(Se(s.data),m.key).then(p):p(s.data)}}}),this.on("disconnect",()=>at(`disconnect (${o})`))}},hr=r=>{r.emit("status",[{connected:r.connected}])},yn=class extends le{constructor(o,s,{signaling:c=["wss://y-webrtc-eu.fly.dev"],password:m=null,awareness:p=new Re(s),maxConns:a=20+ft(Tr()*15),filterBcConns:_=!0,peerOpts:A={}}={}){super(),this.roomName=o,this.doc=s,this.filterBcConns=_,this.awareness=p,this.shouldConnect=!1,this.signalingUrls=c,this.signalingConns=[],this.maxConns=a,this.peerOpts=A,this.key=m?dn(m,o):ie(null),this.room=null,this.key.then(i=>{this.room=Wo(s,this,o,i),this.shouldConnect?this.room.connect():this.room.disconnect(),hr(this)}),this.connect(),this.destroy=this.destroy.bind(this),s.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(o=>{let s=wt(Ue,o,()=>new pr(o));this.signalingConns.push(s),s.providers.add(this)}),this.room&&(this.room.connect(),hr(this))}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(o=>{o.providers.delete(this),o.providers.size===0&&(o.destroy(),Ue.delete(o.url))}),this.room&&(this.room.disconnect(),hr(this))}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),Nt.delete(this.roomName)}),super.destroy()}};export{dr as Room,pr as SignalingConn,ke as WebrtcConn,yn as WebrtcProvider};
/*! Bundled license information:

simple-peer/simplepeer.min.js:
  (*!
  * The buffer module from node.js, for the browser.
  *
  * @author   Feross Aboukhadijeh <https://feross.org>
  * @license  MIT
  *)
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
//# sourceMappingURL=y-webrtc.bundle.mjs.map