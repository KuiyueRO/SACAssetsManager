/* esm.sh - esbuild bundle(d3-quadtree@3.0.1) es2022 production */
function k(i){let t=+this._x.call(null,i),e=+this._y.call(null,i);return I(this.cover(t,e),t,e,i)}function I(i,t,e,n){if(isNaN(t)||isNaN(e))return i;var r,o=i._root,s={data:n},l=i._x0,h=i._y0,f=i._x1,a=i._y1,u,_,p,y,w,x,d,g;if(!o)return i._root=s,i;for(;o.length;)if((w=t>=(u=(l+f)/2))?l=u:f=u,(x=e>=(_=(h+a)/2))?h=_:a=_,r=o,!(o=o[d=x<<1|w]))return r[d]=s,i;if(p=+i._x.call(null,o.data),y=+i._y.call(null,o.data),t===p&&e===y)return s.next=o,r?r[d]=s:i._root=s,i;do r=r?r[d]=new Array(4):i._root=new Array(4),(w=t>=(u=(l+f)/2))?l=u:f=u,(x=e>=(_=(h+a)/2))?h=_:a=_;while((d=x<<1|w)===(g=(y>=_)<<1|p>=u));return r[g]=o,r[d]=s,i}function Q(i){var t,e,n=i.length,r,o,s=new Array(n),l=new Array(n),h=1/0,f=1/0,a=-1/0,u=-1/0;for(e=0;e<n;++e)isNaN(r=+this._x.call(null,t=i[e]))||isNaN(o=+this._y.call(null,t))||(s[e]=r,l[e]=o,r<h&&(h=r),r>a&&(a=r),o<f&&(f=o),o>u&&(u=o));if(h>a||f>u)return this;for(this.cover(h,f).cover(a,u),e=0;e<n;++e)I(this,s[e],l[e],i[e]);return this}function M(i,t){if(isNaN(i=+i)||isNaN(t=+t))return this;var e=this._x0,n=this._y0,r=this._x1,o=this._y1;if(isNaN(e))r=(e=Math.floor(i))+1,o=(n=Math.floor(t))+1;else{for(var s=r-e||1,l=this._root,h,f;e>i||i>=r||n>t||t>=o;)switch(f=(t<n)<<1|i<e,h=new Array(4),h[f]=l,l=h,s*=2,f){case 0:r=e+s,o=n+s;break;case 1:e=r-s,o=n+s;break;case 2:r=e+s,n=o-s;break;case 3:e=r-s,n=o-s;break}this._root&&this._root.length&&(this._root=l)}return this._x0=e,this._y0=n,this._x1=r,this._y1=o,this}function j(){var i=[];return this.visit(function(t){if(!t.length)do i.push(t.data);while(t=t.next)}),i}function X(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function c(i,t,e,n,r){this.node=i,this.x0=t,this.y0=e,this.x1=n,this.y1=r}function Y(i,t,e){var n,r=this._x0,o=this._y0,s,l,h,f,a=this._x1,u=this._y1,_=[],p=this._root,y,w;for(p&&_.push(new c(p,r,o,a,u)),e==null?e=1/0:(r=i-e,o=t-e,a=i+e,u=t+e,e*=e);y=_.pop();)if(!(!(p=y.node)||(s=y.x0)>a||(l=y.y0)>u||(h=y.x1)<r||(f=y.y1)<o))if(p.length){var x=(s+h)/2,d=(l+f)/2;_.push(new c(p[3],x,d,h,f),new c(p[2],s,d,x,f),new c(p[1],x,l,h,d),new c(p[0],s,l,x,d)),(w=(t>=d)<<1|i>=x)&&(y=_[_.length-1],_[_.length-1]=_[_.length-1-w],_[_.length-1-w]=y)}else{var g=i-+this._x.call(null,p.data),q=t-+this._y.call(null,p.data),b=g*g+q*q;if(b<e){var N=Math.sqrt(e=b);r=i-N,o=t-N,a=i+N,u=t+N,n=p.data}}return n}function P(i){if(isNaN(a=+this._x.call(null,i))||isNaN(u=+this._y.call(null,i)))return this;var t,e=this._root,n,r,o,s=this._x0,l=this._y0,h=this._x1,f=this._y1,a,u,_,p,y,w,x,d;if(!e)return this;if(e.length)for(;;){if((y=a>=(_=(s+h)/2))?s=_:h=_,(w=u>=(p=(l+f)/2))?l=p:f=p,t=e,!(e=e[x=w<<1|y]))return this;if(!e.length)break;(t[x+1&3]||t[x+2&3]||t[x+3&3])&&(n=t,d=x)}for(;e.data!==i;)if(r=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,r?(o?r.next=o:delete r.next,this):t?(o?t[x]=o:delete t[x],(e=t[0]||t[1]||t[2]||t[3])&&e===(t[3]||t[2]||t[1]||t[0])&&!e.length&&(n?n[d]=e:this._root=e),this):(this._root=o,this)}function B(i){for(var t=0,e=i.length;t<e;++t)this.remove(i[t]);return this}function C(){return this._root}function D(){var i=0;return this.visit(function(t){if(!t.length)do++i;while(t=t.next)}),i}function E(i){var t=[],e,n=this._root,r,o,s,l,h;for(n&&t.push(new c(n,this._x0,this._y0,this._x1,this._y1));e=t.pop();)if(!i(n=e.node,o=e.x0,s=e.y0,l=e.x1,h=e.y1)&&n.length){var f=(o+l)/2,a=(s+h)/2;(r=n[3])&&t.push(new c(r,f,a,l,h)),(r=n[2])&&t.push(new c(r,o,a,f,h)),(r=n[1])&&t.push(new c(r,f,s,l,a)),(r=n[0])&&t.push(new c(r,o,s,f,a))}return this}function F(i){var t=[],e=[],n;for(this._root&&t.push(new c(this._root,this._x0,this._y0,this._x1,this._y1));n=t.pop();){var r=n.node;if(r.length){var o,s=n.x0,l=n.y0,h=n.x1,f=n.y1,a=(s+h)/2,u=(l+f)/2;(o=r[0])&&t.push(new c(o,s,l,a,u)),(o=r[1])&&t.push(new c(o,a,l,h,u)),(o=r[2])&&t.push(new c(o,s,u,a,f)),(o=r[3])&&t.push(new c(o,a,u,h,f))}e.push(n)}for(;n=e.pop();)i(n.node,n.x0,n.y0,n.x1,n.y1);return this}function G(i){return i[0]}function H(i){return arguments.length?(this._x=i,this):this._x}function J(i){return i[1]}function K(i){return arguments.length?(this._y=i,this):this._y}function m(i,t,e){var n=new A(t??G,e??J,NaN,NaN,NaN,NaN);return i==null?n:n.addAll(i)}function A(i,t,e,n,r,o){this._x=i,this._y=t,this._x0=e,this._y0=n,this._x1=r,this._y1=o,this._root=void 0}function L(i){for(var t={data:i.data},e=t;i=i.next;)e=e.next={data:i.data};return t}var v=m.prototype=A.prototype;v.copy=function(){var i=new A(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,e,n;if(!t)return i;if(!t.length)return i._root=L(t),i;for(e=[{source:t,target:i._root=new Array(4)}];t=e.pop();)for(var r=0;r<4;++r)(n=t.source[r])&&(n.length?e.push({source:n,target:t.target[r]=new Array(4)}):t.target[r]=L(n));return i};v.add=k;v.addAll=Q;v.cover=M;v.data=j;v.extent=X;v.find=Y;v.remove=P;v.removeAll=B;v.root=C;v.size=D;v.visit=E;v.visitAfter=F;v.x=H;v.y=K;export{m as quadtree};
//# sourceMappingURL=d3-quadtree.mjs.map